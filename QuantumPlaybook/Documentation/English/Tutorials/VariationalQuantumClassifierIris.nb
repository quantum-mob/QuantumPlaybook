(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    136309,       3438]
NotebookOptionsPosition[    117419,       3051]
NotebookOutlinePosition[    120228,       3116]
CellTagsIndexPosition[    120185,       3113]
WindowTitle->Variational Quantum Classifier: Iris
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell[
          "QUANTUM MOB/ QUANTUM PLAYBOOK TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "64fb23e0-a43e-4ee9-9166-7f36e16bf443"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "cb443690-e418-4b01-9eca-f20d6de8185e"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "56883ea0-7a33-4da6-a273-5ea25d096f42"]
         }],ExpressionUUID->"c035db4c-98ed-4423-a854-94ab2e33c586"],
         StripOnInput->False],{
        StyleBox[
          "\"AmplitudeEmbedding\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/AmplitudeEmbedding"], 
         StyleBox[
          "\"AmplitudeEmbeddingGate\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/QuantumPlaybook/ref/AmplitudeEmbeddingGate"], 
         StyleBox["\"FindMinimum\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:ref/FindMinimum"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "0865e628-88b0-48e8-90a6-bf606819362f"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "1173294a-8d5e-4e3c-bc1e-b53bddb329d8"]
         }],ExpressionUUID->"17df3119-0a6c-496f-8f44-74dacc46033d"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d8546fad-6d30-4765-a4cd-3ed3fb3896fc"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "1d39d996-0800-4b98-8698-1e95f3b12de9"]
         }],ExpressionUUID->"52f5fdb1-8d74-4a5b-a9c3-0b84c8c9c398"],
         StripOnInput->False],{
        "\"A Quantum Playbook\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/QuantumPlaybook/tutorial/QuantumPlaybook"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"], 
         "\"Variational classifier\"" :> 
         Documentation`HelpLookup[
          "paclet:https://pennylane.ai/qml/demos/tutorial_variational_\
classifier"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "0f157e8b-35f0-4d01-8e51-70db3d5a826d"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ccf22349-a03f-40fd-bf2a-8c67693adc1b"]
         }],ExpressionUUID->"2302f4d9-1077-463f-a432-298ff17cc0a5"],
         StripOnInput->False],{
        "\"QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris"], Delimiter, "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/\
QuantumPlaybook/tutorial/VariationalQuantumClassifierIris.html"], 
                   StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c0bcbed9-2ce8-4b51-988c-a300ab762484"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "13833f2c-76ab-4187-a130-fea4cf9dab7f"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"eeb55ded-72c7-4086-994f-be40b46f916a"],

Cell[CellGroupData[{

Cell["Variational Quantum Classifier: Iris", "TechNoteTitle",
 CellID->2105495953,ExpressionUUID->"6acfcdab-90c5-4ddd-8236-90d5af26d446"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Amplitude Embedding: Method"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris#1429043704", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Quantum Circuit Layer"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris#75111769", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Data"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris#1388635064", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Optimization"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/\
VariationalQuantumClassifierIris#1684028550", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"3ea3665d-0a9a-4e6e-8f5d-\
7aa106cd4bb3"],

Cell[TextData[{
 "This demonstration is a translation of the tutorial \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Variational classifier"]], 
    "https://pennylane.ai/qml/demos/tutorial_variational_classifier"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "871e3f6b-7a75-4cbc-8302-06354276cb10"],
 "\[CloseCurlyDoubleQuote] in PennyLane by Maria Schuld. It demonstrates \
variational quantum classifiers; that is, quantum circuits that can be \
trained from labelled data to classify new data samples."
}], "TechNoteText",
 CellID->239396700,ExpressionUUID->"7cd6ff8b-3508-48f0-b05c-aba3b4a3044d"],

Cell["\<\
In particular, we will see how to encode real vectors as amplitude vectors \
(amplitude encoding) and train the model to recognize the first two classes \
of flowers in the Iris dataset.\
\>", "TechNoteText",
 CellID->1384746856,ExpressionUUID->"df82f249-1b80-4bc4-b56f-23b86202568a"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["AmplitudeEmbedding"]], 
      "paclet:QuantumMob/Q3/ref/AmplitudeEmbedding", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Encodes data into amplitudes of a quantum state", "TechNoteTableText",
     ExpressionUUID->"8086f356-650f-4564-a4b3-09cb30ae7cde"]},
   {
    TemplateBox[{
      Cell[
       TextData["AmplitudeEmbeddingGate"]], 
      "paclet:QuantumMob/QuantumPlaybook/ref/AmplitudeEmbeddingGate", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Quantum circuit model to implement amplitude embedding", 
     "TechNoteTableText",ExpressionUUID->
     "b22ee115-5ebe-44a2-afa9-9c1abc7543da"]},
   {
    TemplateBox[{
      Cell[
       TextData["FindMinimum"]], "paclet:ref/FindMinimum"},
     "RefLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Find the minimum of a function", "TechNoteTableText",ExpressionUUID->
     "55249596-b3c7-40a2-a17f-0515a23c3170"]}
  }]], "DefinitionBox",
 CellID->1292802137,ExpressionUUID->"bc78334a-cf3a-4046-a5c2-c63f360bb6a4"],

Cell["Frequently used function in variational classification.", \
"TechNoteCaption",
 CellID->2033459860,ExpressionUUID->"ddb77e71-7ca8-42a2-8e51-c24f7c734606"],

Cell["Make sure to load the Q3 package:", "TechNoteMathCaption",
 CellID->1305108662,ExpressionUUID->"e8ee5237-ccff-43b6-a1e0-617bce58282f"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->563311776,ExpressionUUID->"038a5758-c446-4ac0-8959-64a28ffb680f"],

Cell[CellGroupData[{

Cell["Amplitude Embedding: Method", "TechNoteSection",
 CellID->1429043704,ExpressionUUID->"a48ad650-6a56-49cd-a78b-f24ce9e570b4"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->956170878,ExpressionUUID->"00ad7890-244f-4c70-9672-bf9807158cb7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[3]:=",
 CellID->2009201136,ExpressionUUID->"dce304ca-f2cf-4728-a1d5-c2bb2a8cc68c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2026965477,ExpressionUUID->"9207668e-d41b-4264-85e8-b7c4ad268651"]
}, Open  ]],

Cell["Get the data:", "TechNoteText",
 CellID->1227282214,ExpressionUUID->"210164b1-077b-4332-8f23-0e8c87eee883"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "4312", "]"}], ";"}]], "Input",
 CellLabel->"In[14]:=",
 CellID->1097642951,ExpressionUUID->"5e65f731-f171-435f-8a92-68eee2b62444"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aa", "=", 
  RowBox[{"Normalize", "@", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "$N"}], "]"}]}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->189403710,ExpressionUUID->"99ffddce-d03e-45fd-beea-e569512400b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.570628023396442`", ",", "0.481166894222071`", ",", "0.5667675595275355`",
    ",", "0.34876440799851927`"}], "}"}]], "Output",
 CellLabel->"Out[15]=",
 CellID->1775536252,ExpressionUUID->"59ee4087-e760-4fa6-b74e-6e2cd2d617d9"]
}, Open  ]],

Cell["Embed the data into a quantum state:", "TechNoteText",
 CellID->1361434470,ExpressionUUID->"b1fb2af2-9765-4962-a0eb-94f0de3edf0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"AmplitudeEncoding", "[", 
   RowBox[{"aa", ",", "SS"}], "]"}]}]], "Input",
 CellLabel->"In[18]:=",
 CellID->552373815,ExpressionUUID->"73b02fd1-e873-4e1d-a451-f16e623bb54a"],

Cell[BoxData[
 RowBox[{"AmplitudeEncoding", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.570628023396442`", ",", "0.481166894222071`", ",", 
     "0.5667675595275355`", ",", "0.34876440799851927`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[18]=",
 CellID->754587502,ExpressionUUID->"1930b81b-56be-4aa0-91ee-9c9669c11ba9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"op", "**", 
   RowBox[{"Ket", "[", "]"}]}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->670373711,ExpressionUUID->"fd72006c-ad9c-45ad-8cee-cce7a0b8b087"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.570628023396442`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4811668942220708`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.5667675595275357`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.34876440799851927`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[19]=",
 CellID->1774443654,ExpressionUUID->"21010c6d-86b0-41fd-98b3-1aa4c9cc3af1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum circuit implementation", "Subsection",
 CellID->204972709,ExpressionUUID->"cc3ff900-9e78-45c2-8018-038c859c973f"],

Cell["\<\
Embedding the data into a quantum state as above on actual quantum computer \
is not trivial. One implementation based on quantum circuit model may be \
achieved by the following function.\
\>", "TechNoteText",
 CellID->1736806247,ExpressionUUID->"1e69c354-5c2b-45a5-909b-7cdf00a2637e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[20]:=",
 CellID->2115840818,ExpressionUUID->"a0ef96b4-ec00-4304-8f15-543e0aee625c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{1, -1}, 0.18], 
       {LightDarkSwitched[
         GrayLevel[0]], DiskBox[{1, -1}, 0.0675]}}, 
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{1, -2}, 0.18], 
       {LightDarkSwitched[
         GrayLevel[0]], DiskBox[{1, -2}, 0.0675]}}}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`AmplitudeEncoding[{0.570628023396442, 0.481166894222071, 
    0.5667675595275355, 0.34876440799851927`}, {
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[20]=",
 CellID->79933125,ExpressionUUID->"b104aa5e-3806-48fa-844e-0742db42b12b"]
}, Open  ]],

Cell["\<\
More explicitly, the above quantum circuit is equivalent to the following:\
\>", "TechNoteText",
 CellID->1982607710,ExpressionUUID->"7ba30770-d901-45b7-9bc3-2ef33a91879a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{"UnfoldAll", "@", "op"}], "]"}]], "Input",
 CellLabel->"In[21]:=",
 CellID->1294444264,ExpressionUUID->"80930e06-ecca-4136-a40d-94a42b0a0778"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{2, -1}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`Rotation[1.4562702905895477`, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 0}, 
    QuantumMob`Q3`Rotation[1.4010934222911824`, {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[1.103269963015618, {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$]]]]]], "Output",
 CellLabel->"Out[21]=",
 CellID->1116237627,ExpressionUUID->"bfad5305-175d-43cc-8d56-bfd18115f60f"]
}, Open  ]],

Cell["The above quantum circuit may be further simplified:", "TechNoteText",
 CellID->1636934043,ExpressionUUID->"a20b0535-61cd-4343-b7d8-f0c5a48a4d6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"GateFactor", "/@", 
    RowBox[{"Unfold", "@", "op"}]}], "]"}]}]], "Input",
 CellLabel->"In[22]:=",
 CellID->1083978179,ExpressionUUID->"e527d293-b32b-4f4f-bfcb-35d8ee2e957d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`Rotation[1.4562702905895477`, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]], 
   QuantumMob`Q3`UniformlyControlledRotation[{
     $CellContext`S[1, QuantumMob`Q3`$]}, {1.4010934222911824`, 
    1.103269963015618}, {0, 1, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[22]=",
 CellID->173278145,ExpressionUUID->"62a15575-6bab-4511-b4f3-3db19b35fca7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"qc", "**", 
    RowBox[{"Ket", "[", "SS", "]"}]}], "//", "Chop"}]}]], "Input",
 CellLabel->"In[23]:=",
 CellID->1374028304,ExpressionUUID->"37cd5988-49cf-41cf-815b-7a885a42e037"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.570628023396442`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{"0.4811668942220708`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  RowBox[{"0.5667675595275357`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{"0.34876440799851927`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[23]=",
 CellID->1321894904,ExpressionUUID->"3954a208-636b-4613-9ab0-233e5b3caa1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fidelity", "[", 
  RowBox[{"new", ",", "in", ",", "SS"}], "]"}]], "Input",
 CellLabel->"In[24]:=",
 CellID->1785928077,ExpressionUUID->"11b57cfd-6b4b-4739-93ed-7e8160be7709"],

Cell[BoxData["1.`"], "Output",
 CellLabel->"Out[24]=",
 CellID->329219208,ExpressionUUID->"dd5a1143-d361-4531-b75a-1c1e59865ac5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "TechNoteSection",
 CellID->1388635064,ExpressionUUID->"6121bfda-813b-481c-92dc-87a9f0d4ed6b"],

Cell[CellGroupData[{

Cell["Data loading and embedding", "Subsection",
 CellID->1773260592,ExpressionUUID->"6a05cf82-8d39-4b26-b613-93b9f300fae9"],

Cell["Import the iris date and check the first three entries:", \
"TechNoteMathCaption",
 CellID->1862114914,ExpressionUUID->"711d3fe1-a50c-4d8b-a1eb-ad6e1535b53e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "PacletObject", "[", "\"\<QuantumMob/QuantumPlaybook\>\"", "]"}], "[", 
      RowBox[{"\"\<AssetLocation\>\"", ",", "\"\<Iris\>\""}], "]"}], 
     ",", "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Most", "[", "#", "]"}], "->", 
       RowBox[{"Round", "[", 
        RowBox[{"Last", "@", "#"}], "]"}]}], "&"}], ",", "raw"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"raw", "[", 
  RowBox[{"[", 
   RowBox[{";;", "3"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",
 CellID->714456690,ExpressionUUID->"3d54bf35-527f-4c85-92dc-b7ef4b48b46e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.3999999999999999112`18.602059991327963", ",", "0.75`18.8750612633917",
       ",", "0.1999999999999999556`18.30102999566398", ",", 
      "0.05000000000000000278`18.698970004336022"}], "}"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.3000000000000002665`18.477121254719663", ",", 
      "0.5`18.698970004336022", ",", 
      "0.1999999999999999556`18.30102999566398", ",", 
      "0.05000000000000000278`18.698970004336022"}], "}"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.2000000000000001776`18.301029995663985", ",", 
      "0.6000000000000000888`18.778151250383644", ",", 
      "0.1500000000000000222`18.17609125905568", ",", 
      "0.05000000000000000278`18.698970004336022"}], "}"}], "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "}"}]], "Output",
 CellLabel->"Out[27]=",
 CellID->1851361577,ExpressionUUID->"752dabc1-c0ee-4525-a447-788e3c78d2d7"]
}, Open  ]],

Cell["Renormalize the data:", "TechNoteMathCaption",
 CellID->1383867640,ExpressionUUID->"2e820cd9-2458-4a97-9dde-246fe7cd1ded"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Normalize", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", "2"}], "]"}], ",", 
           RowBox[{"0.3", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}]}], "&"}], ",", 
       RowBox[{"Keys", "@", "raw"}]}], "]"}], "->", 
     RowBox[{"Values", "[", "raw", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"data", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellLabel->"In[28]:=",
 CellID->1155092402,ExpressionUUID->"b4cb63a2-4827-4299-9b4a-c68d7526bf5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "0.4437601569801833`", ",", "0.8320502943378438`", ",", 
    "0.33282011773513753`", ",", "0.`"}], "}"}], "\[Rule]", 
  RowBox[{"-", "1"}]}]], "Output",
 CellLabel->"Out[29]=",
 CellID->343817116,ExpressionUUID->"6be09104-49f6-44d5-98da-105750b0b7de"]
}, Open  ]],

Cell["\<\
Here, vector representation is nothing but the input data itself since we \
just simulate the amplitude embedding.\
\>", "TechNoteText",
 CellID->1311209471,ExpressionUUID->"3e147784-9be2-4ebf-bfee-12a3bda809e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"in", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"AmplitudeEncoding", "[", 
         RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", "data", "]"}]}], "//", "Chop"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"in", "=", 
     RowBox[{"Matrix", "[", 
      RowBox[{"in", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"$in", "=", 
    RowBox[{"Keys", "[", "data", "]"}]}], ";"}]}]], "Input",
 CellLabel->"In[30]:=",
 CellID->151923758,ExpressionUUID->"11832e15-7e01-4c99-bc7b-08e72f1eb64e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Features", "Subsection",
 CellID->768952789,ExpressionUUID->"c4a33c59-5a39-4403-aec6-cad1f0132482"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
     RowBox[{"GroupBy", "[", 
      RowBox[{"raw", ",", "Last", ",", 
       RowBox[{"Map", "[", "First", "]"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "0.02", "]"}], ",", "Red", ",", 
     RowBox[{"Point", "/@", 
      RowBox[{"gg", "[", "1", "]"}]}], ",", "Blue", ",", 
     RowBox[{"Point", "/@", 
      RowBox[{"gg", "[", 
       RowBox[{"-", "1"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLabel", "->", "\"\<Original\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "->", "Medium"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}]}], "]"}]}], "Input",
 CellLabel->"In[31]:=",
 CellID->1608604657,ExpressionUUID->"7e91d6cd-d75d-4a9b-b4bc-976827d5b3f8"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], PointSize[
   0.02], {PointBox[{1.35, 0.6000000000000001}], 
    PointBox[{1.0500000000000003`, 0.6000000000000001}], 
    PointBox[{1.3000000000000003`, 0.55}], 
    PointBox[{0.6000000000000001, 0.1499999999999999}], 
    PointBox[{1.1, 0.3999999999999999}], 
    PointBox[{0.7000000000000002, 0.3999999999999999}], 
    PointBox[{1., 0.6499999999999999}], 
    PointBox[{0.30000000000000027`, 0.19999999999999996`}], 
    PointBox[{1.15, 0.44999999999999996`}], 
    PointBox[{0.4500000000000002, 0.3500000000000001}], 
    PointBox[{0.3500000000000001, 0.}], PointBox[{0.8000000000000003, 0.5}], 
    PointBox[{0.8500000000000001, 0.10000000000000009`}], 
    PointBox[{0.8999999999999999, 0.44999999999999996`}], 
    PointBox[{0.6499999999999999, 0.44999999999999996`}], 
    PointBox[{1.2000000000000002`, 0.55}], 
    PointBox[{0.6499999999999999, 0.5}], PointBox[{0.75, 0.3500000000000001}],
     PointBox[{0.9500000000000002, 0.10000000000000009`}], 
    PointBox[{0.6499999999999999, 0.25}], 
    PointBox[{0.8000000000000003, 0.6000000000000001}], 
    PointBox[{0.8999999999999999, 0.3999999999999999}], PointBox[{1., 0.25}], 
    PointBox[{0.8999999999999999, 0.3999999999999999}], 
    PointBox[{1.0500000000000003`, 0.44999999999999996`}], 
    PointBox[{1.15, 0.5}], PointBox[{1.25, 0.3999999999999999}], 
    PointBox[{1.2000000000000002`, 0.5}], 
    PointBox[{0.8500000000000001, 0.44999999999999996`}], 
    PointBox[{0.7000000000000002, 0.30000000000000004`}], 
    PointBox[{0.6000000000000001, 0.19999999999999996`}], 
    PointBox[{0.6000000000000001, 0.19999999999999996`}], 
    PointBox[{0.75, 0.3500000000000001}], 
    PointBox[{0.8500000000000001, 0.3500000000000001}], 
    PointBox[{0.5500000000000003, 0.5}], PointBox[{0.8500000000000001, 0.7}], 
    PointBox[{1.2000000000000002`, 0.55}], PointBox[{1., 0.1499999999999999}],
     PointBox[{0.6499999999999999, 0.5}], 
    PointBox[{0.6000000000000001, 0.25}], 
    PointBox[{0.6000000000000001, 0.30000000000000004`}], 
    PointBox[{0.8999999999999999, 0.5}], 
    PointBox[{0.75, 0.30000000000000004`}], 
    PointBox[{0.3500000000000001, 0.1499999999999999}], 
    PointBox[{0.6499999999999999, 0.3500000000000001}], 
    PointBox[{0.7000000000000002, 0.5}], 
    PointBox[{0.7000000000000002, 0.44999999999999996`}], 
    PointBox[{0.9500000000000002, 0.44999999999999996`}], 
    PointBox[{0.3999999999999999, 0.25}], 
    PointBox[{0.7000000000000002, 0.3999999999999999}]}, 
   {RGBColor[0, 0, 1], PointBox[{0.3999999999999999, 0.75}], 
    PointBox[{0.30000000000000027`, 0.5}], 
    PointBox[{0.20000000000000018`, 0.6000000000000001}], 
    PointBox[{0.1499999999999999, 0.55}], PointBox[{0.3500000000000001, 0.8}],
     PointBox[{0.5500000000000003, 0.95}], 
    PointBox[{0.1499999999999999, 0.7}], PointBox[{0.3500000000000001, 0.7}], 
    PointBox[{0.050000000000000266`, 0.44999999999999996`}], 
    PointBox[{0.30000000000000027`, 0.55}], 
    PointBox[{0.5500000000000003, 0.8500000000000001}], PointBox[{0.25, 0.7}],
     PointBox[{0.25, 0.5}], PointBox[{0., 0.5}], PointBox[{0.75, 1.}], 
    PointBox[{0.7000000000000002, 1.2000000000000002`}], 
    PointBox[{0.5500000000000003, 0.95}], 
    PointBox[{0.3999999999999999, 0.75}], 
    PointBox[{0.7000000000000002, 0.8999999999999999}], 
    PointBox[{0.3999999999999999, 0.8999999999999999}], 
    PointBox[{0.5500000000000003, 0.7}], 
    PointBox[{0.3999999999999999, 0.8500000000000001}], 
    PointBox[{0.1499999999999999, 0.8}], 
    PointBox[{0.3999999999999999, 0.6499999999999999}], PointBox[{0.25, 0.7}],
     PointBox[{0.3500000000000001, 0.5}], PointBox[{0.3500000000000001, 0.7}],
     PointBox[{0.4500000000000002, 0.75}], 
    PointBox[{0.4500000000000002, 0.7}], 
    PointBox[{0.20000000000000018`, 0.6000000000000001}], 
    PointBox[{0.25, 0.55}], PointBox[{0.5500000000000003, 0.7}], 
    PointBox[{0.4500000000000002, 1.0499999999999998`}], 
    PointBox[{0.6000000000000001, 1.1}], 
    PointBox[{0.30000000000000027`, 0.55}], 
    PointBox[{0.3500000000000001, 0.6000000000000001}], 
    PointBox[{0.6000000000000001, 0.75}], 
    PointBox[{0.30000000000000027`, 0.55}], 
    PointBox[{0.050000000000000266`, 0.5}], 
    PointBox[{0.3999999999999999, 0.7}], PointBox[{0.3500000000000001, 0.75}],
     PointBox[{0.10000000000000009`, 0.1499999999999999}], 
    PointBox[{0.050000000000000266`, 0.6000000000000001}], 
    PointBox[{0.3500000000000001, 0.75}], 
    PointBox[{0.3999999999999999, 0.8999999999999999}], PointBox[{0.25, 0.5}],
     PointBox[{0.3999999999999999, 0.8999999999999999}], 
    PointBox[{0.1499999999999999, 0.6000000000000001}], 
    PointBox[{0.5, 0.8500000000000001}], 
    PointBox[{0.3500000000000001, 0.6499999999999999}]}},
  Frame->True,
  ImageSize->Medium,
  PlotLabel->FormBox["\"Original\"", TraditionalForm],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[32]=",
 CellID->1585695494,ExpressionUUID->"575b9d18-939e-4aab-84e5-f8ce9f861a91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
     RowBox[{"GroupBy", "[", 
      RowBox[{"data", ",", "Last", ",", 
       RowBox[{"Map", "[", "First", "]"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "0.02", "]"}], ",", "Red", ",", 
     RowBox[{"Point", "/@", 
      RowBox[{"gg", "[", "1", "]"}]}], ",", "Blue", ",", 
     RowBox[{"Point", "/@", 
      RowBox[{"gg", "[", 
       RowBox[{"-", "1"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLabel", "->", "\"\<Renormalized\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "->", "Medium"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}]}], "]"}]}], "Input",
 CellLabel->"In[33]:=",
 CellID->60442629,ExpressionUUID->"8d7e8261-9c6b-4ea0-bce3-9e599fddfe7a"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], PointSize[
   0.02], {PointBox[{0.8955334711889903, 0.3980148760839957}], 
    PointBox[{0.8427009716003844, 0.48154341234307674`}], 
    PointBox[{0.9008466072778083, 0.3811274107713804}], 
    PointBox[{0.8728715609439696, 0.21821789023599222`}], 
    PointBox[{0.9103664774626048, 0.3310423554409471}], 
    PointBox[{0.8137334712067351, 0.46499055497527697`}], 
    PointBox[{0.8131156281817418, 0.5285251583181321}], 
    PointBox[{0.6396021490668317, 0.4264014327112206}], 
    PointBox[{0.9049228966693288, 0.35410026391408517`}], 
    PointBox[{0.6985354731356997, 0.5433053679944331}], 
    PointBox[{0.7592566023652968, 0.}], 
    PointBox[{0.8081220356417685, 0.5050762722761052}], 
    PointBox[{0.9372403389139511, 0.11026356928399433`}], 
    PointBox[{0.857142857142857, 0.4285714285714285}], 
    PointBox[{0.7687061147858074, 0.5321811563901744}], 
    PointBox[{0.8864602261837413, 0.4062942703342148}], 
    PointBox[{0.7443778346080285, 0.5725983343138682}], 
    PointBox[{0.8519427513705973, 0.39757328397294545`}], 
    PointBox[{0.9488147219339523, 0.09987523388778453}], 
    PointBox[{0.8571946154145232, 0.3296902366978936}], 
    PointBox[{0.766261028176921, 0.5746957711326907}], 
    PointBox[{0.8741572761215377, 0.3885143449429056}], 
    PointBox[{0.9314928656652445, 0.23287321641631112`}], 
    PointBox[{0.8741572761215377, 0.3885143449429056}], 
    PointBox[{0.8890008890013336, 0.38100038100057143`}], 
    PointBox[{0.8919017444789036, 0.3877833671647407}], 
    PointBox[{0.9284766908852592, 0.2971125410832829}], 
    PointBox[{0.8994380267950337, 0.37476584449793066`}], 
    PointBox[{0.8436958338752908, 0.44666250028691856`}], 
    PointBox[{0.8551861104941365, 0.3665083330689156}], 
    PointBox[{0.8571428571428572, 0.2857142857142856}], 
    PointBox[{0.8571428571428572, 0.2857142857142856}], 
    PointBox[{0.8519427513705973, 0.39757328397294545`}], 
    PointBox[{0.8790490729915327, 0.36196138299651354`}], 
    PointBox[{0.686161147706986, 0.6237828615518052}], 
    PointBox[{0.7447835223751499, 0.6133511360736528}], 
    PointBox[{0.8864602261837413, 0.4062942703342148}], 
    PointBox[{0.9480909262799545, 0.1422136389419931}], 
    PointBox[{0.7443778346080285, 0.5725983343138682}], 
    PointBox[{0.8381163549234938, 0.349215147884789}], 
    PointBox[{0.8164965809277261, 0.4082482904638631}], 
    PointBox[{0.8392543274162824, 0.4662524041201569}], 
    PointBox[{0.8703882797784892, 0.34815531191139576`}], 
    PointBox[{0.7219948723811555, 0.3094263738776378}], 
    PointBox[{0.8156925466796062, 0.4392190635967112}], 
    PointBox[{0.7683498199278327, 0.5488212999484517}], 
    PointBox[{0.7913267865219101, 0.5087100770497992}], 
    PointBox[{0.8690397721180617, 0.41165041837171334`}], 
    PointBox[{0.7155417527999326, 0.447213595499958}], 
    PointBox[{0.8137334712067351, 0.46499055497527697`}]}, 
   {RGBColor[0, 0, 1], PointBox[{0.4437601569801833, 0.8320502943378438}], 
    PointBox[{0.45749571099781433`, 0.7624928516630232}], 
    PointBox[{0.28571428571428586`, 0.857142857142857}], 
    PointBox[{0.2328451577118997, 0.8537655782769662}], 
    PointBox[{0.3790712527517177, 0.8664485777182117}], 
    PointBox[{0.4833122526801217, 0.8348120728111189}], 
    PointBox[{0.19324698792024916`, 0.9018192769611633}], 
    PointBox[{0.41758499039032565`, 0.835169980780651}], 
    PointBox[{0.09205746178983285, 0.8285171561084911}], 
    PointBox[{0.4318894504492171, 0.791797325823564}], 
    PointBox[{0.5208650961914163, 0.8049733304776431}], 
    PointBox[{0.3118914307759027, 0.8732960061725276}], 
    PointBox[{0.39405520311955033`, 0.7881104062391007}], 
    PointBox[{0., 0.8574929257125443}], 
    PointBox[{0.5834323811883105, 0.777909841584414}], 
    PointBox[{0.4925182813112044, 0.8443170536763502}], 
    PointBox[{0.4833122526801217, 0.8348120728111189}], 
    PointBox[{0.4437601569801833, 0.8320502943378438}], 
    PointBox[{0.5937322507759797, 0.7633700367119737}], 
    PointBox[{0.3885143449429056, 0.8741572761215377}], 
    PointBox[{0.5854709249535847, 0.7451448135772892}], 
    PointBox[{0.40561610125071496`, 0.8619342151577696}], 
    PointBox[{0.17291712531127038`, 0.922224668326776}], 
    PointBox[{0.48776860867975386`, 0.7926239891046001}], 
    PointBox[{0.3118914307759027, 0.8732960061725276}], 
    PointBox[{0.5146502354656656, 0.7352146220938078}], 
    PointBox[{0.41758499039032565`, 0.835169980780651}], 
    PointBox[{0.48666426339228774`, 0.8111071056538126}], 
    PointBox[{0.5087100770497994, 0.7913267865219099}], 
    PointBox[{0.28571428571428586`, 0.857142857142857}], 
    PointBox[{0.3706246583305506, 0.8153742483272114}], 
    PointBox[{0.5854709249535847, 0.7451448135772892}], 
    PointBox[{0.3810003810005717, 0.8890008890013334}], 
    PointBox[{0.4656903154237997, 0.8537655782769661}], 
    PointBox[{0.4318894504492171, 0.791797325823564}], 
    PointBox[{0.4625730203185629, 0.7929823205461077}], 
    PointBox[{0.596284793999944, 0.74535599249993}], 
    PointBox[{0.4318894504492171, 0.791797325823564}], 
    PointBox[{0.08543576577167655, 0.854357657716761}], 
    PointBox[{0.4649905549752771, 0.813733471206735}], 
    PointBox[{0.39757328397294545`, 0.8519427513705973}], 
    PointBox[{0.2857142857142859, 0.42857142857142827`}], 
    PointBox[{0.07432941462471704, 0.8919529754965998}], 
    PointBox[{0.39757328397294545`, 0.8519427513705973}], 
    PointBox[{0.3885143449429056, 0.8741572761215377}], 
    PointBox[{0.39405520311955033`, 0.7881104062391007}], 
    PointBox[{0.3885143449429056, 0.8741572761215377}], 
    PointBox[{0.21821789023599222`, 0.8728715609439696}], 
    PointBox[{0.48507125007266594`, 0.8246211251235321}], 
    PointBox[{0.4392190635967112, 0.8156925466796062}]}},
  Frame->True,
  ImageSize->Medium,
  PlotLabel->FormBox["\"Renormalized\"", TraditionalForm],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[34]=",
 CellID->1536105691,ExpressionUUID->"9be2df84-b372-44aa-b4a8-cdc97545d609"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RR", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"AmplitudeEncoding", "[", 
      RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"Keys", "[", "data", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", 
       RowBox[{";;", 
        RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR", "=", 
   RowBox[{
    RowBox[{"List", "@@@", 
     RowBox[{"Map", "[", 
      RowBox[{"UnfoldAll", ",", 
       RowBox[{"Unfold", "/@", "RR"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"CNOT", "->", "Nothing"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angles", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"RotationAngle", ",", "RR", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[42]:=",
 CellID->1026929483,ExpressionUUID->"a5df3159-ea48-496e-98b3-2743ebcc9a83"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tf", "=", 
   RowBox[{
    RowBox[{"Positive", "[", 
     RowBox[{"Values", "@", "data"}], "]"}], "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"Pick", "[", 
    RowBox[{
     RowBox[{"angles", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", 
        RowBox[{";;", "2"}]}], "]"}], "]"}], ",", "tf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Pick", "[", 
    RowBox[{
     RowBox[{"angles", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", 
        RowBox[{";;", "2"}]}], "]"}], "]"}], ",", 
     RowBox[{"Not", "/@", "tf"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "0.02", "]"}], ",", "Red", ",", 
     RowBox[{"Point", "/@", "aa"}], ",", "Blue", ",", 
     RowBox[{"Point", "/@", "bb"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "->", "\"\<Rotation angles for amplitude embedding\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "->", "Medium"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}]}], "]"}]}], "Input",
 CellLabel->"In[45]:=",
 CellID->1092986670,ExpressionUUID->"b1fdc3d8-e759-4716-8520-d3e9ebaef8c5"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], PointSize[
   0.02], {PointBox[{0.4006899920563046, 0.4182243295792291}], 
    PointBox[{0.4863217384476618, 0.5191461142465229}], 
    PointBox[{0.41882992328200874`, 0.40024065703397416`}], 
    PointBox[{0.9032668821590634, 0.24497866312686398`}], 
    PointBox[{0.5018121534678908, 0.34877100358390695`}], 
    PointBox[{0.712458952303745, 0.5191461142465227}], 
    PointBox[{0.492842090495526, 0.5763752205911835}], 
    PointBox[{1.3879611898019875`, 0.5880026035475671}], 
    PointBox[{0.47663258782152423`, 0.372987721800061}], 
    PointBox[{0.9688290294678071, 0.6610431688506866}], 
    PointBox[{1.4172525442553405`, 0.}], 
    PointBox[{0.6157741831439829, 0.5585993153435623}], 
    PointBox[{0.6742826581914103, 0.11710874456686436`}], 
    PointBox[{0.579503402872095, 0.46364760900080615`}], 
    PointBox[{0.7253734101974755, 0.6055446636049701}], 
    PointBox[{0.4469407997891632, 0.4297622790966885}], 
    PointBox[{0.7014079143260563, 0.6556956262415363}], 
    PointBox[{0.6954866996254414, 0.4366271598135414}], 
    PointBox[{0.6086006138799324, 0.10487693873023397`}], 
    PointBox[{0.8135036990705129, 0.3671738338182192}], 
    PointBox[{0.582913588955734, 0.6435011087932844}], 
    PointBox[{0.5913502789460471, 0.41822432957922906`}], 
    PointBox[{0.5664380225258422, 0.24497866312686414`}], 
    PointBox[{0.5913502789460471, 0.41822432957922906`}], 
    PointBox[{0.5136278348416143, 0.4048917862850833}], 
    PointBox[{0.469644300295317, 0.41012734054149114`}], 
    PointBox[{0.4494420408603226, 0.30970294454245617`}], 
    PointBox[{0.4535976961077718, 0.3947911196997615}], 
    PointBox[{0.6047221463102104, 0.48689923181126893`}], 
    PointBox[{0.7505068539833734, 0.4048917862850833}], 
    PointBox[{0.8858220881472777, 0.321750554396642}], 
    PointBox[{0.8858220881472777, 0.321750554396642}], 
    PointBox[{0.6954866996254414, 0.4366271598135414}], 
    PointBox[{0.6309174948384184, 0.39060704369768684`}], 
    PointBox[{0.767218258203787, 0.7378150601204645}], 
    PointBox[{0.5319803967160164, 0.6889243882148612}], 
    PointBox[{0.4469407997891632, 0.4297622790966885}], 
    PointBox[{0.5768179583905261, 0.14888994760949717`}], 
    PointBox[{0.7014079143260563, 0.6556956262415363}], 
    PointBox[{0.8648155511410758, 0.3947911196997615}], 
    PointBox[{0.8410686705679302, 0.46364760900080615`}], 
    PointBox[{0.5670704097785719, 0.507098504392337}], 
    PointBox[{0.7112051659610665, 0.38050637711236496`}], 
    PointBox[{1.3345626738664076`, 0.40489178628508304`}], 
    PointBox[{0.7719735236752996, 0.49394136891958135`}], 
    PointBox[{0.6711089685429331, 0.6202494859828214}], 
    PointBox[{0.6920052467863715, 0.5713374798336267}], 
    PointBox[{0.5560013019676103, 0.44237422297674484`}], 
    PointBox[{1.132938891404671, 0.5585993153435626}], 
    PointBox[{0.712458952303745, 0.5191461142465227}]}, 
   {RGBColor[0, 0, 1], PointBox[{0.6785852289080895, 1.0808390005411685`}], 
    PointBox[{0.95035369899619, 1.0303768265243118`}], 
    PointBox[{0.8858220881472778, 1.2490457723982544`}], 
    PointBox[{0.9688290294678077, 1.3045442776439715`}], 
    PointBox[{0.661850502961901, 1.1583858851975095`}], 
    PointBox[{0.5335561604165479, 1.0460005551447893`}], 
    PointBox[{0.793654250415982, 1.3597029935721503`}], 
    PointBox[{0.7321001376934244, 1.1071487177940904`}], 
    PointBox[{1.1703487938086496`, 1.460139105621001}], 
    PointBox[{0.8931732675510052, 1.071449605114766}], 
    PointBox[{0.57615241411638, 0.9964914966201945}], 
    PointBox[{0.7672182582037873, 1.2277723863741932`}], 
    PointBox[{0.9850817038612817, 1.1071487177940902`}], 
    PointBox[{1.0808390005411685`, 1.5707963267948966`}], 
    PointBox[{0.47108996144172666`, 0.9272952180016123}], 
    PointBox[{0.42535793851214426`, 1.0427218783685368`}], 
    PointBox[{0.5335561604165479, 1.0460005551447893`}], 
    PointBox[{0.6785852289080895, 1.0808390005411685`}], 
    PointBox[{0.5145716959800262, 0.9097531579442096}], 
    PointBox[{0.5913502789460471, 1.1525719972156676`}], 
    PointBox[{0.6500822912062881, 0.9048270894157866}], 
    PointBox[{0.6182223873041665, 1.1309537439791608`}], 
    PointBox[{0.7062555047051441, 1.3854483767992019`}], 
    PointBox[{0.7490413178699818, 1.0191413442663497`}], 
    PointBox[{0.7672182582037873, 1.2277723863741932`}], 
    PointBox[{0.913712099961471, 0.960070362405688}], 
    PointBox[{0.7321001376934244, 1.1071487177940904`}], 
    PointBox[{0.6608452958229668, 1.030376826524312}], 
    PointBox[{0.6920052467863714, 0.9994588469612696}], 
    PointBox[{0.8858220881472778, 1.2490457723982544`}], 
    PointBox[{0.9217893166110505, 1.144168833668021}], 
    PointBox[{0.6500822912062881, 0.9048270894157866}], 
    PointBox[{0.5136278348416143, 1.165904540509813}], 
    PointBox[{0.4700044671836117, 1.0714496051147666`}], 
    PointBox[{0.8931732675510052, 1.071449605114766}], 
    PointBox[{0.8153831436890697, 1.042721878368537}], 
    PointBox[{0.6054919032460087, 0.896055384571344}], 
    PointBox[{0.8931732675510052, 1.071449605114766}], 
    PointBox[{1.0764542976239155`, 1.4711276743037347`}], 
    PointBox[{0.7124589523037451, 1.0516502125483735`}], 
    PointBox[{0.6954866996254414, 1.1341691669813554`}], 
    PointBox[{2.0593936016755023`, 0.9827937232473285}], 
    PointBox[{0.9245299159541048, 1.4876550949064573`}], 
    PointBox[{0.6954866996254414, 1.1341691669813554`}], 
    PointBox[{0.5913502789460471, 1.1525719972156676`}], 
    PointBox[{0.9850817038612817, 1.1071487177940902`}], 
    PointBox[{0.5913502789460471, 1.1525719972156676`}], 
    PointBox[{0.9032668821590634, 1.3258176636680328`}], 
    PointBox[{0.5906331810558995, 1.0390722595360908`}], 
    PointBox[{0.7719735236752996, 1.0768549578753153`}]}},
  Frame->True,
  ImageSize->Medium,
  PlotLabel->FormBox[
   "\"Rotation angles for amplitude embedding\"", TraditionalForm],
  PlotRangePadding->Scaled[0.025]]], "Output",
 CellLabel->"Out[48]=",
 CellID->139328985,ExpressionUUID->"aedbaf10-b712-4f02-870f-624ce562c18e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Circuit Layer", "TechNoteSection",
 CellID->75111769,ExpressionUUID->"75cf0059-7e18-49c2-8dd1-769c03bc055f"],

Cell["Construct the basic quantum circuit layer to use:", \
"TechNoteMathCaption",
 CellID->1813517192,ExpressionUUID->"83d9605a-2b5d-435d-a369-13f48e492e48"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "w"}], "]"}]], "Input",
 CellLabel->"In[49]:=",
 CellID->370649814,ExpressionUUID->"c81dbba7-4986-4bde-ae82-fe8ec1df5692"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"layer", "[", "lyr_Integer", "]"}], ":=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EulerRotation", "[", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"lyr", ",", "k", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"k", ",", "$"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "$n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layer", "[", 
   RowBox[{"ll", ":", 
    RowBox[{"{", "__Integer", "}"}]}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"QuantumCircuit", ",", 
    RowBox[{"layer", "/@", "ll"}]}], "]"}]}]}], "Input",
 CellLabel->"In[50]:=",
 CellID->1624746193,ExpressionUUID->"81116443-8d52-47bc-9491-f81f85288335"],

Cell["Check it by show two layers:", "TechNoteMathCaption",
 CellID->2103269434,ExpressionUUID->"dc90aad4-a17d-48b2-90c1-8fb050e057cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"layer", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], "]"}]], "Input",
 CellLabel->"In[52]:=",
 CellID->1956082550,ExpressionUUID->"09b57423-9685-449e-9fb6-23650c16ee95"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 1, 1], 
      $CellContext`w[1, 1, 2], 
      $CellContext`w[1, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 2, 1], 
      $CellContext`w[1, 2, 2], 
      $CellContext`w[1, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 1, 1], 
      $CellContext`w[2, 1, 2], 
      $CellContext`w[2, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 2, 1], 
      $CellContext`w[2, 2, 2], 
      $CellContext`w[2, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[52]=",
 CellID->323151418,ExpressionUUID->"dccb9d6e-870e-4081-98de-8026c868b36c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization", "TechNoteSection",
 CellID->1684028550,ExpressionUUID->"87fa74ae-b7bf-4a80-ac97-7a4341e8bf1a"],

Cell[CellGroupData[{

Cell["Using three layers", "Subsection",
 CellID->372963104,ExpressionUUID->"d15a6ae6-c6bb-4fbf-9952-12b4070cea08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$L", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$layer", "=", 
  RowBox[{"layer", "[", 
   RowBox[{"Range", "@", "$L"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$mat", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{"$layer", ",", "SS"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[53]:=",
 CellID->1836026386,ExpressionUUID->"873b3182-3e61-43b2-a74e-7177a999fa51"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {5., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {5., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], {CircleBox[{6, -2}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -2}, {6.266666666666667, -2}}, {{
         6, -2.2666666666666666`}, {6, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 1, 1], 
      $CellContext`w[1, 1, 2], 
      $CellContext`w[1, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 2, 1], 
      $CellContext`w[1, 2, 2], 
      $CellContext`w[1, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 1, 1], 
      $CellContext`w[2, 1, 2], 
      $CellContext`w[2, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 2, 1], 
      $CellContext`w[2, 2, 2], 
      $CellContext`w[2, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[3, 1, 1], 
      $CellContext`w[3, 1, 2], 
      $CellContext`w[3, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[3, 2, 1], 
      $CellContext`w[3, 2, 2], 
      $CellContext`w[3, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[54]=",
 CellID->331544561,ExpressionUUID->"601009ec-ade1-4aef-8eb1-129c5bc27067"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ww", "=", 
   RowBox[{"w", "[", 
    RowBox[{
     RowBox[{"Range", "@", "$L"}], ",", 
     RowBox[{"Range", "@", "$n"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraints", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"0", "<=", "ww", "<", "Pi"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[56]:=",
 CellID->1331466339,ExpressionUUID->"d5c432fb-f8ab-4647-8ca8-612502718533"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w0", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "*", "Pi"}], ",", 
      RowBox[{"{", 
       RowBox[{"$L", ",", "$n", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[58]:=",
 CellID->1805190685,ExpressionUUID->"f99bd579-7d28-4dbb-a81e-80124bf9cd54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z1", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[59]:=",
 CellID->2017713712,ExpressionUUID->"acef922d-a4c0-4f3b-be58-4e28b116c4dd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "optimizer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optimizer", "[", "w0_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ii", "=", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "data"}]}], ",", "4"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "yy", ",", "vv", ",", "avg", ",", "sol", ",", 
      "cost"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yy", "=", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Values", "@", "data"}], ",", "ii"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vv", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Part", "[", 
        RowBox[{"$in", ",", "ii"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vv", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"$mat", ".", "vv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"avg", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", "#", "]"}], ".", "Z1", ".", "#"}], "&"}], 
        ",", "vv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       RowBox[{"Mean", "@", 
        RowBox[{"Abs", "[", 
         RowBox[{"avg", "-", "yy"}], "]"}]}], "^", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EchoTiming", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cost", ",", "sol"}], "}"}], "=", 
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cost", ",", "constraints"}], "}"}], ",", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"ww", ",", "w0"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StepMonitor", ":>", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<Cost: \>\"", ",", "cost"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "->", "\"\<IPOPT\>\""}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"avg", "/.", "sol"}], "]"}], ",", "yy", ",", "cost"}], 
        "}"}], ",", "\"\<{avg, yy, cost}\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ww", "/.", "sol"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[60]:=",
 CellID->450103983,ExpressionUUID->"24275212-9eb4-492e-b140-b0d810e088d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"optimizer", "[", "w0", "]"}]], "Input",
 CellLabel->"In[62]:=",
 CellID->248896434,ExpressionUUID->"988c2c0b-fd09-48b8-8311-7cae98bc85ac"],

Cell[CellGroupData[{

Cell[BoxData["1.418814`"], "EchoTiming",
 CellID->1825387052,ExpressionUUID->"edc1c1a2-25fa-43c7-995d-0dc88ec5a974"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.9875334179678136`"}], ",", "0.47164817455117647`", ",", 
      
      RowBox[{"-", "0.7824685657598174`"}], ",", 
      RowBox[{"-", "0.9935162407378191`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.036560652324574644`"}], 
   "}"}]}]], "Echo",
 CellID->328801922,ExpressionUUID->"b8e4e3cc-943a-45ca-81ed-761a1e373d16"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.4110841016880957`", ",", "1.3196325493298977`", ",", 
   "0.6009117147180788`", ",", "0.5719744146911072`", ",", 
   "2.0973449146234877`", ",", "2.1941039127140156`", ",", 
   "3.006465115000594`", ",", "1.9668546855312858`", ",", 
   "1.5919587696903914`", ",", "1.0406699227844949`", ",", 
   "2.396850851945145`", ",", "3.057809134457687`", ",", 
   "1.0299664887631594`", ",", "0.7387474395529257`", ",", 
   "2.0942651563893926`", ",", "2.4398177555440177`", ",", 
   "1.5534063910277172`", ",", "0.7897963155301551`"}], "}"}]], "Output",
 CellLabel->"Out[62]=",
 CellID->698479323,ExpressionUUID->"06d1ce9c-2010-4b57-83ff-cfb2625b95ed"]
}, Open  ]],

Cell["Find the optimal values of the parameters iteratively.", "TechNoteText",
 CellID->1706189206,ExpressionUUID->"e6edcb9f-2516-49ac-9edd-864da7787803"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$R", "=", "5"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "number", " ", "of", " ", "iterations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{"optimizer", ",", "w0", ",", "$R"}], "]"}]}]}], "Input",
 CellLabel->"In[63]:=",
 CellID->601893948,ExpressionUUID->"4be6f401-6a90-4b76-a3f6-3b45cebd45fe"],

Cell[CellGroupData[{

Cell[BoxData["2.98744`"], "EchoTiming",
 CellID->483620126,ExpressionUUID->"5d58f87f-cd43-4725-91a9-aa2d1553589f"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.634306857386963`", ",", 
      RowBox[{"-", "0.9371273536947213`"}], ",", 
      RowBox[{"-", "0.9996977115232146`"}], ",", 
      RowBox[{"-", "0.8927485553304257`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.01796400887117846`"}], 
   "}"}]}]], "Echo",
 CellID->2125337434,ExpressionUUID->"d24cb55b-fa62-4405-b451-7b0ef4a0a4bd"],

Cell[BoxData["1.561054`"], "EchoTiming",
 CellID->2125233859,ExpressionUUID->"1990595a-3a9b-4043-859c-e129420972cb"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.6122511076826422`"}], ",", "0.4783710332226325`", ",", 
      RowBox[{"-", "0.5923124334349226`"}], ",", "0.6802729377336627`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0.16744310303321525`"}], 
   "}"}]}]], "Echo",
 CellID->1857451309,ExpressionUUID->"34b3b7b2-47f1-4e8e-8151-038d087c91b1"],

Cell[BoxData["1.282635`"], "EchoTiming",
 CellID->1140328572,ExpressionUUID->"ad75fc3c-1fc2-405a-804b-57c1e27b6d68"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.9502430236356965`", ",", "0.9273841294597748`", ",", 
      RowBox[{"-", "0.077470602382331`"}], ",", "0.9502430236356965`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0.07489242561699017`"}], 
   "}"}]}]], "Echo",
 CellID->1358243776,ExpressionUUID->"3d480b16-668b-405c-8a1a-17aa24a75f55"],

Cell[BoxData["1.591417`"], "EchoTiming",
 CellID->377375778,ExpressionUUID->"a148ce6f-ff8b-415d-a96f-2a8da9dad9cc"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.8799519526811258`", ",", "0.9979784141790571`", ",", 
      "0.8196743788934167`", ",", 
      RowBox[{"-", "0.17693469980045973`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.07916634122586019`"}], 
   "}"}]}]], "Echo",
 CellID->1035491255,ExpressionUUID->"47a7001c-e570-435a-8f5e-9391a5ce60ab"],

Cell[BoxData["2.972211`"], "EchoTiming",
 CellID->1353604580,ExpressionUUID->"ff9a516e-ce9e-4395-872e-07a5222e1bf7"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.1895517704201703`", ",", 
      RowBox[{"-", "0.9169768754323889`"}], ",", 
      RowBox[{"-", "0.9829244477839566`"}], ",", 
      RowBox[{"-", "0.9169768754323889`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.0616988378977761`"}], 
   "}"}]}]], "Echo",
 CellID->1737903389,ExpressionUUID->"ebbb08a6-5f06-46f0-a52c-9df4a8d82c4d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.008726669919128`", ",", "1.5798194720852923`", ",", 
   "1.3190820317589278`", ",", "1.6686550825736322`", ",", 
   "2.0863326833413276`", ",", "0.2044712482403712`", ",", 
   "1.8500807572534212`", ",", "2.8735905048456236`", ",", 
   "0.8396752086704754`", ",", "0.20691297701608516`", ",", 
   "1.7453187170241284`", ",", "2.541136538129672`", ",", 
   "1.4930419171929756`", ",", "1.547385236706289`", ",", 
   "1.5952566246977584`", ",", "1.741525847643929`", ",", 
   "1.5636312900998783`", ",", "1.4198487428245072`"}], "}"}]], "Output",
 CellLabel->"Out[64]=",
 CellID->1017176076,ExpressionUUID->"f618474c-9ac1-4f1b-8d4a-3f5f7c7dc6ed"]
}, Open  ]],

Cell["From the optimized parameters, make predictions:", "TechNoteText",
 CellID->1452621094,ExpressionUUID->"ca83e6b6-febc-4ab1-bf06-921ba2eae771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"$mat", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"ww", "->", "new"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[65]:=",
 CellID->1659547112,ExpressionUUID->"94af7041-c97d-4fc8-bc53-6457f76f6fde"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"mm", ".", 
     RowBox[{"Transpose", "[", "$in", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"predicted", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sign", "@", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", "#", "]"}], ".", "Z1", ".", "#"}], "]"}]}], 
     "&"}], ",", "vv"}], "]"}]}]}], "Input",
 CellLabel->"In[66]:=",
 CellID->961867375,ExpressionUUID->"5b12f869-1aec-44cb-8674-817fcaa4dbc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellLabel->"Out[67]=",
 CellID->902383345,ExpressionUUID->"b5100dd0-4c9e-4dfa-88a2-66d7c6d08169"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"predicted", "-", 
  RowBox[{"Values", "[", "data", "]"}]}]], "Input",
 CellLabel->"In[68]:=",
 CellID->1832052457,ExpressionUUID->"dbc90af8-5f48-45f7-b922-153f6d56c9ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}]}], "}"}]], "Output",
 CellLabel->"Out[68]=",
 CellID->1723146043,ExpressionUUID->"cc580135-fb75-419a-a99a-22300e838a6f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using five layers", "Subsection",
 CellID->1250334885,ExpressionUUID->"e374de5d-36d5-41dd-a985-9678a31ffadc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$L", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$layer", "=", 
  RowBox[{"layer", "[", 
   RowBox[{"Range", "@", "$L"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$mat", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{"$layer", ",", "SS"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[69]:=",
 CellID->1250926300,ExpressionUUID->"cb0fdc16-79fd-4fe7-bf17-afacd437c0d5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {5., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {5., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], {CircleBox[{6, -2}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -2}, {6.266666666666667, -2}}, {{
         6, -2.2666666666666666`}, {6, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {7., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {7., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {9., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"R\"\>", "\<\"E\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.03636363636363637],
        FontWeight->"Light",
        FontSlant->Italic], {9., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{10, -1}, {10, -2}}], 
     DiskBox[{10, -1}, 0.09], {CircleBox[{10, -2}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -2}, {10.266666666666667`, -2}}, {{
         10, -2.2666666666666666`}, {10, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 1, 1], 
      $CellContext`w[1, 1, 2], 
      $CellContext`w[1, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[1, 2, 1], 
      $CellContext`w[1, 2, 2], 
      $CellContext`w[1, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 1, 1], 
      $CellContext`w[2, 1, 2], 
      $CellContext`w[2, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[2, 2, 1], 
      $CellContext`w[2, 2, 2], 
      $CellContext`w[2, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[3, 1, 1], 
      $CellContext`w[3, 1, 2], 
      $CellContext`w[3, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[3, 2, 1], 
      $CellContext`w[3, 2, 2], 
      $CellContext`w[3, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[4, 1, 1], 
      $CellContext`w[4, 1, 2], 
      $CellContext`w[4, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[4, 2, 1], 
      $CellContext`w[4, 2, 2], 
      $CellContext`w[4, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], {
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[5, 1, 1], 
      $CellContext`w[5, 1, 2], 
      $CellContext`w[5, 1, 3]}, 
     $CellContext`S[1, QuantumMob`Q3`$]], 
    QuantumMob`Q3`EulerRotation[{
      $CellContext`w[5, 2, 1], 
      $CellContext`w[5, 2, 2], 
      $CellContext`w[5, 2, 3]}, 
     $CellContext`S[2, QuantumMob`Q3`$]]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[70]=",
 CellID->1592316978,ExpressionUUID->"29ea6b89-15dc-4afc-b59c-66468c5060b8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ww", "=", 
   RowBox[{"w", "[", 
    RowBox[{
     RowBox[{"Range", "@", "$L"}], ",", 
     RowBox[{"Range", "@", "$n"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraints", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"0", "<=", "ww", "<", "Pi"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[72]:=",
 CellID->1357456234,ExpressionUUID->"c7a868b4-376a-4d8d-86bc-bcc9915e9b0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w0", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "*", "Pi"}], ",", 
      RowBox[{"{", 
       RowBox[{"$L", ",", "$n", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[74]:=",
 CellID->2048142757,ExpressionUUID->"13868baa-c777-46e8-a639-e29d7e07a71d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z1", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[75]:=",
 CellID->1119939136,ExpressionUUID->"298f458f-543e-4b51-aff1-26e3374b000b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "optimizer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optimizer", "[", "w0_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ii", "=", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "data"}]}], ",", "4"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "yy", ",", "vv", ",", "avg", ",", "sol", ",", 
      "cost"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yy", "=", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Values", "@", "data"}], ",", "ii"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vv", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Part", "[", 
        RowBox[{"$in", ",", "ii"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vv", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"$mat", ".", "vv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"avg", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", "#", "]"}], ".", "Z1", ".", "#"}], "&"}], 
        ",", "vv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       RowBox[{"Mean", "@", 
        RowBox[{"Abs", "[", 
         RowBox[{"avg", "-", "yy"}], "]"}]}], "^", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EchoTiming", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cost", ",", "sol"}], "}"}], "=", 
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cost", ",", "constraints"}], "}"}], ",", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"ww", ",", "w0"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StepMonitor", ":>", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<Cost: \>\"", ",", "cost"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "->", "\"\<IPOPT\>\""}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"avg", "/.", "sol"}], "]"}], ",", "yy", ",", "cost"}], 
        "}"}], ",", "\"\<{avg, yy, cost}\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ww", "/.", "sol"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[76]:=",
 CellID->122892797,ExpressionUUID->"989b4cde-ab73-4882-8f7f-ac1d303de108"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"optimizer", "[", "w0", "]"}]], "Input",
 CellLabel->"In[78]:=",
 CellID->1727454412,ExpressionUUID->"3e52323e-a5c2-47af-97dc-44e0431dbe0b"],

Cell[CellGroupData[{

Cell[BoxData["16.311765`"], "EchoTiming",
 CellID->388310646,ExpressionUUID->"d12146bb-a976-4f62-85bf-4a00b3afd920"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.5735279979384492`"}], ",", 
      RowBox[{"-", "0.5095398646771726`"}], ",", "0.4699341412534459`", ",", 
      "0.5792813166304815`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
    "0.218022849680262`"}], "}"}]}]], "Echo",
 CellID->134224089,ExpressionUUID->"1ae0d2b0-bcba-48a7-a978-7acbbcea6acf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.2831747735393868`", ",", "2.9282494186037744`", ",", 
   "0.7231755969786781`", ",", "1.2096268578349725`", ",", 
   "1.155515097959125`", ",", "0.40501759398038856`", ",", 
   "1.0868921822739843`", ",", "1.4906599213040108`", ",", 
   "0.424001192117715`", ",", "1.7539271445374807`", ",", 
   "1.307864507607018`", ",", "2.918214605449584`", ",", 
   "1.7349845927783811`", ",", "1.530912705013904`", ",", 
   "2.098967848439176`", ",", "0.14579091797644292`", ",", 
   "1.1631346077266518`", ",", "1.2321716906061748`", ",", 
   "2.527581715342433`", ",", "0.8302128814915056`", ",", 
   "2.4549957299234393`", ",", "0.9780444236033028`", ",", 
   "1.4846256062106888`", ",", "2.62433598938215`", ",", "2.33394253624684`", 
   ",", "0.09490639144615738`", ",", "1.2259712380087426`", ",", 
   "0.7704222286642362`", ",", "2.3319795660800695`", ",", 
   "1.52989288698112`"}], "}"}]], "Output",
 CellLabel->"Out[78]=",
 CellID->1046434473,ExpressionUUID->"aebf77c1-8b74-4732-b0d2-90ab3e8ba584"]
}, Open  ]],

Cell["Find the optimal values of the parameters iteratively:", "TechNoteText",
 CellID->2052016225,ExpressionUUID->"70e1febb-60ae-4e52-ae94-7feaa43cd894"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$R", "=", "5"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "number", " ", "of", " ", "iterations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"new", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{"optimizer", ",", "w0", ",", "$R"}], "]"}]}]}], "Input",
 CellLabel->"In[79]:=",
 CellID->1796806402,ExpressionUUID->"dc6f6be6-f935-4168-9dc0-f0d588eaac60"],

Cell[CellGroupData[{

Cell[BoxData["14.079826`"], "EchoTiming",
 CellID->1620696619,ExpressionUUID->"a8de14b5-1862-4919-89af-81ab8b4906b0"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.9941893747637759`", ",", 
      RowBox[{"-", "0.10273187489884984`"}], ",", "0.677347037012469`", ",", 
      "0.9880416506186611`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
    "0.09574229320761163`"}], "}"}]}]], "Echo",
 CellID->365496985,ExpressionUUID->"866b03c9-c8a3-4a02-b1de-7aabd3e3599d"],

Cell[BoxData["26.916155`"], "EchoTiming",
 CellID->338475932,ExpressionUUID->"ffa216f5-33ff-4fe1-8486-43a5163c8a38"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.9969643169090816`"}], ",", 
      RowBox[{"-", "0.7984032273934141`"}], ",", 
      RowBox[{"-", "0.11277539835579839`"}], ",", 
      RowBox[{"-", "0.9494844142863104`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.1169509085664975`"}], 
   "}"}]}]], "Echo",
 CellID->80808221,ExpressionUUID->"910cf06f-b433-44f8-8da4-b4c1338a1a18"],

Cell[BoxData["32.878459`"], "EchoTiming",
 CellID->2092271953,ExpressionUUID->"ad522a8f-3071-42e4-95c5-079d3bb96b8a"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.4092577284168601`"}], ",", "0.736942483257911`", ",", 
      RowBox[{"-", "0.6949977355133278`"}], ",", "0.30200555117992756`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0.2154808280295461`"}], 
   "}"}]}]], "Echo",
 CellID->1917478093,ExpressionUUID->"ab26a058-1b9c-4596-ae77-0edebd59c136"],

Cell[BoxData["13.395622`"], "EchoTiming",
 CellID->892730156,ExpressionUUID->"5f88b2fa-d457-4bc5-8730-1c25b0ec8582"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.902952053653851`"}], ",", "0.11640688535127287`", ",", 
      RowBox[{"-", "0.9578915325115912`"}], ",", 
      RowBox[{"-", "0.9603904203620222`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.07053792966301276`"}], 
   "}"}]}]], "Echo",
 CellID->1794973950,ExpressionUUID->"d0b4d060-1ee0-4509-bb3e-d3e0983cfb92"],

Cell[BoxData["10.466885`"], "EchoTiming",
 CellID->1703628961,ExpressionUUID->"4efeaff9-fecc-4853-a408-8230db475075"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"{avg, yy, cost}\"\>",
   "EchoLabel"], "  ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.7440345141044262`", ",", 
      RowBox[{"-", "0.7284723173223907`"}], ",", "0.564658732999874`", ",", 
      RowBox[{"-", "0.5852210168737391`"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", "0.1186136707113197`"}], 
   "}"}]}]], "Echo",
 CellID->492482076,ExpressionUUID->"dc7f3709-beed-4dae-aa79-d05089187f37"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.5405490128693535`", ",", "1.8692078414275473`", ",", 
   "0.7912041981055531`", ",", "1.7525436699449826`", ",", 
   "1.9881898368794824`", ",", "0.8701388938478213`", ",", 
   "1.9551744442492023`", ",", "1.8215322364649964`", ",", 
   "1.106557706898404`", ",", "1.063069307817499`", ",", 
   "1.5074041727569543`", ",", "1.7780159558119673`", ",", 
   "2.5432084298817967`", ",", "0.9400032187736528`", ",", 
   "2.593425583617318`", ",", "0.7951406582517764`", ",", 
   "1.3879293783429432`", ",", "1.2598067568795266`", ",", 
   "2.4086330620915555`", ",", "1.32639219320463`", ",", "2.613828891286652`",
    ",", "0.8774002349755698`", ",", "1.5370517976787796`", ",", 
   "2.2560844745696462`", ",", "2.0800449472501255`", ",", 
   "0.713288840447767`", ",", "1.6514444921246096`", ",", 
   "1.0387651707114742`", ",", "2.078696541457914`", ",", 
   "1.542680563015222`"}], "}"}]], "Output",
 CellLabel->"Out[80]=",
 CellID->744275794,ExpressionUUID->"9655aa9f-316f-4081-a1ae-d68a18c32a75"]
}, Open  ]],

Cell["From the optimized parameters, make predictions:", "TechNoteText",
 CellID->1364328016,ExpressionUUID->"1da6b1fa-b350-4700-bd42-8a0da6394f2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"$mat", "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"ww", "->", "new"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[81]:=",
 CellID->1578065893,ExpressionUUID->"73777618-0faa-40d4-8656-6ac3c4593770"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"mm", ".", 
     RowBox[{"Transpose", "[", "$in", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"predicted", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sign", "@", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", "#", "]"}], ".", "Z1", ".", "#"}], "]"}]}], 
     "&"}], ",", "vv"}], "]"}]}]}], "Input",
 CellLabel->"In[82]:=",
 CellID->1130423201,ExpressionUUID->"92a136d7-f6fa-4fe7-999e-76f5d244ddfd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
  "}"}]], "Output",
 CellLabel->"Out[83]=",
 CellID->1641248024,ExpressionUUID->"985bfbbf-9d8e-45a1-a60c-e42720d692b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"predicted", "-", 
  RowBox[{"Values", "[", "data", "]"}]}]], "Input",
 CellLabel->"In[84]:=",
 CellID->1127982600,ExpressionUUID->"877a9ed2-1a99-4dd3-a203-47858fa8d1da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
    "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[84]=",
 CellID->1405875095,ExpressionUUID->"e3cd5e91-dfa9-43e7-950d-6ef9efc41705"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "9e0399e3-eacb-4efa-84ff-63ffd7478a03"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Many-Body Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "df9d4a51-ed5d-4cdb-8907-29188db23e9f"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Spin Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumSpinSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "4e58b308-8061-4dd1-83fa-c43cae9b29c2"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"8a63f198-9a83-4f3e-b0b2-\
4f9efd2017eb"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "A Quantum Playbook",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/QuantumPlaybook/tutorial/QuantumPlaybook"]], 
         "RelatedTutorials",ExpressionUUID->
         "a600b68e-5550-4085-beac-b94508224f41"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "f6722204-9c67-4121-afb0-ebeb9b4f5f92"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Many-Body Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"]],
          "RelatedTutorials",ExpressionUUID->
         "da675dab-002c-4253-b599-c709aee62624"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Spin Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "c8073379-4c16-4fbd-8603-46f4d260ea36"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"c7b3dce1-dafd-4f12-82e2-\
5e6772a0d8f7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        "Maria Should, PennyLane demonstration \[OpenCurlyDoubleQuote]",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Variational classifier"]], 
           "https://pennylane.ai/qml/demos/tutorial_variational_classifier"},
          "WebLink",
          BaseStyle->{"RelatedTutorials"}]],ExpressionUUID->
         "ef17bf97-3323-4f21-9323-1a771079b6cd"],
        "\[CloseCurlyDoubleQuote]."
       }], "RelatedTutorials",ExpressionUUID->
        "194ea466-1d69-4912-b5bc-da395f43acb5"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b513403d-918d-4c98-8397-21a8207b2087"]}]],ExpressionUUID->
         "c98a852b-ab9c-4713-835c-c7b664ba2296"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c29d5a97-130f-4b9c-a8ba-56f45f4ce85c"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"ee3611df-8e84-435d-9104-\
2031d6a13968"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"196643a4-34fd-4cf0-8e1a-d33bb474a2fe"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Variational Quantum Classifier: Iris",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2023", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 10, 5, 15, 6, 47.346284}", 
    "history" -> {"13.3", "", "", ""}, "context" -> 
    "QuantumMob`QuantumPlaybook`", 
    "keywords" -> {
     "quantum machine learning", "variational quantum classifier"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Quantum Playbook Tech Note", "language" -> "en",
     "paclet" -> "QuantumMob/QuantumPlaybook", "status" -> "None", "summary" -> 
    "This demonstration is a translation of the tutorial 'Variational \
classifier' in PennyLane by Maria Schuld. It demonstrates variational quantum \
classifiers; that is, quantum circuits that can be trained from labelled data \
to classify new data samples. In particular, we will see how to encode real \
vectors as amplitude vectors (amplitude encoding) and train the model to \
recognize the first two classes of flowers in the Iris dataset. Get the \
data:", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Variational Quantum Classifier: Iris", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> 
    "Variational Quantum Classifier: Iris", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/QuantumPlaybook/tutorial/VariationalQuantumClassifierIris"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"664b9c1f-f72c-43ce-93be-9f2e7f72b874"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[604, 21, 7725, 187, 70, "AnchorBarGrid",ExpressionUUID->"eeb55ded-72c7-4086-994f-be40b46f916a",
 CellID->1],
Cell[CellGroupData[{
Cell[8354, 212, 137, 1, 70, "TechNoteTitle",ExpressionUUID->"6acfcdab-90c5-4ddd-8236-90d5af26d446",
 CellID->2105495953],
Cell[8494, 215, 4008, 92, 70, "TechNoteJumpBox",ExpressionUUID->"3ea3665d-0a9a-4e6e-8f5d-7aa106cd4bb3"],
Cell[12505, 309, 658, 14, 70, "TechNoteText",ExpressionUUID->"7cd6ff8b-3508-48f0-b05c-aba3b4a3044d",
 CellID->239396700],
Cell[13166, 325, 294, 5, 70, "TechNoteText",ExpressionUUID->"df82f249-1b80-4bc4-b56f-23b86202568a",
 CellID->1384746856],
Cell[13463, 332, 1212, 31, 70, "DefinitionBox",ExpressionUUID->"bc78334a-cf3a-4046-a5c2-c63f360bb6a4",
 CellID->1292802137],
Cell[14678, 365, 160, 2, 70, "TechNoteCaption",ExpressionUUID->"ddb77e71-7ca8-42a2-8e51-c24f7c734606",
 CellID->2033459860],
Cell[14841, 369, 140, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e8ee5237-ccff-43b6-a1e0-617bce58282f",
 CellID->1305108662],
Cell[14984, 372, 177, 3, 70, "Input",ExpressionUUID->"038a5758-c446-4ac0-8959-64a28ffb680f",
 CellID->563311776],
Cell[CellGroupData[{
Cell[15186, 379, 130, 1, 70, "TechNoteSection",ExpressionUUID->"a48ad650-6a56-49cd-a78b-f24ce9e570b4",
 CellID->1429043704],
Cell[15319, 382, 181, 4, 70, "Input",ExpressionUUID->"00ad7890-244f-4c70-9672-bf9807158cb7",
 CellID->956170878],
Cell[CellGroupData[{
Cell[15525, 390, 504, 14, 70, "Input",ExpressionUUID->"dce304ca-f2cf-4728-a1d5-c2bb2a8cc68c",
 CellID->2009201136],
Cell[16032, 406, 470, 14, 70, "Output",ExpressionUUID->"9207668e-d41b-4264-85e8-b7c4ad268651",
 CellID->2026965477]
}, Open  ]],
Cell[16517, 423, 113, 1, 70, "TechNoteText",ExpressionUUID->"210164b1-077b-4332-8f23-0e8c87eee883",
 CellID->1227282214],
Cell[16633, 426, 184, 4, 70, "Input",ExpressionUUID->"5e65f731-f171-435f-8a92-68eee2b62444",
 CellID->1097642951],
Cell[CellGroupData[{
Cell[16842, 434, 297, 8, 70, "Input",ExpressionUUID->"99ffddce-d03e-45fd-beea-e569512400b5",
 CellID->189403710],
Cell[17142, 444, 271, 6, 70, "Output",ExpressionUUID->"59ee4087-e760-4fa6-b74e-6e2cd2d617d9",
 CellID->1775536252]
}, Open  ]],
Cell[17428, 453, 136, 1, 70, "TechNoteText",ExpressionUUID->"b1fb2af2-9765-4962-a0eb-94f0de3edf0f",
 CellID->1361434470],
Cell[CellGroupData[{
Cell[17589, 458, 219, 5, 70, "Input",ExpressionUUID->"73b02fd1-e873-4e1d-a451-f16e623bb54a",
 CellID->552373815],
Cell[17811, 465, 711, 20, 70, "Output",ExpressionUUID->"1930b81b-56be-4aa0-91ee-9c9669c11ba9",
 CellID->754587502]
}, Open  ]],
Cell[CellGroupData[{
Cell[18559, 490, 200, 5, 70, "Input",ExpressionUUID->"fd72006c-ad9c-45ad-8cee-cce7a0b8b087",
 CellID->670373711],
Cell[18762, 497, 3801, 92, 70, "Output",ExpressionUUID->"21010c6d-86b0-41fd-98b3-1aa4c9cc3af1",
 CellID->1774443654]
}, Open  ]],
Cell[CellGroupData[{
Cell[22600, 594, 127, 1, 70, "Subsection",ExpressionUUID->"cc3ff900-9e78-45c2-8018-038c859c973f",
 CellID->204972709],
Cell[22730, 597, 296, 5, 70, "TechNoteText",ExpressionUUID->"1e69c354-5c2b-45a5-909b-7cdf00a2637e",
 CellID->1736806247],
Cell[CellGroupData[{
Cell[23051, 606, 168, 3, 70, "Input",ExpressionUUID->"a0ef96b4-ec00-4304-8f15-543e0aee625c",
 CellID->2115840818],
Cell[23222, 611, 1036, 24, 70, "Output",ExpressionUUID->"b104aa5e-3806-48fa-844e-0742db42b12b",
 CellID->79933125]
}, Open  ]],
Cell[24273, 638, 182, 3, 70, "TechNoteText",ExpressionUUID->"7ba30770-d901-45b7-9bc3-2ef33a91879a",
 CellID->1982607710],
Cell[CellGroupData[{
Cell[24480, 645, 199, 4, 70, "Input",ExpressionUUID->"80930e06-ecca-4136-a40d-94a42b0a0778",
 CellID->1294444264],
Cell[24682, 651, 2386, 55, 70, "Output",ExpressionUUID->"bfad5305-175d-43cc-8d56-bfd18115f60f",
 CellID->1116237627]
}, Open  ]],
Cell[27083, 709, 152, 1, 70, "TechNoteText",ExpressionUUID->"a20b0535-61cd-4343-b7d8-f0c5a48a4d6c",
 CellID->1636934043],
Cell[CellGroupData[{
Cell[27260, 714, 256, 6, 70, "Input",ExpressionUUID->"e527d293-b32b-4f4f-bfcb-35d8ee2e957d",
 CellID->1083978179],
Cell[27519, 722, 2069, 49, 70, "Output",ExpressionUUID->"62a15575-6bab-4511-b4f3-3db19b35fca7",
 CellID->173278145]
}, Open  ]],
Cell[CellGroupData[{
Cell[29625, 776, 237, 6, 70, "Input",ExpressionUUID->"37cd5988-49cf-41cf-815b-7a885a42e037",
 CellID->1374028304],
Cell[29865, 784, 3474, 83, 70, "Output",ExpressionUUID->"3954a208-636b-4613-9ab0-233e5b3caa1c",
 CellID->1321894904]
}, Open  ]],
Cell[CellGroupData[{
Cell[33376, 872, 198, 4, 70, "Input",ExpressionUUID->"11b57cfd-6b4b-4739-93ed-7e8160be7709",
 CellID->1785928077],
Cell[33577, 878, 129, 2, 70, "Output",ExpressionUUID->"dd5a1143-d361-4531-b75a-1c1e59865ac5",
 CellID->329219208]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33767, 887, 107, 1, 70, "TechNoteSection",ExpressionUUID->"6121bfda-813b-481c-92dc-87a9f0d4ed6b",
 CellID->1388635064],
Cell[CellGroupData[{
Cell[33899, 892, 124, 1, 70, "Subsection",ExpressionUUID->"6a05cf82-8d39-4b26-b613-93b9f300fae9",
 CellID->1773260592],
Cell[34026, 895, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"711d3fe1-a50c-4d8b-a1eb-ad6e1535b53e",
 CellID->1862114914],
Cell[CellGroupData[{
Cell[34215, 901, 804, 24, 70, "Input",ExpressionUUID->"3d54bf35-527f-4c85-92dc-b7ef4b48b46e",
 CellID->714456690],
Cell[35022, 927, 1051, 27, 70, "Output",ExpressionUUID->"752dabc1-c0ee-4525-a447-788e3c78d2d7",
 CellID->1851361577]
}, Open  ]],
Cell[36088, 957, 128, 1, 70, "TechNoteMathCaption",ExpressionUUID->"2e820cd9-2458-4a97-9dde-246fe7cd1ded",
 CellID->1383867640],
Cell[CellGroupData[{
Cell[36241, 962, 742, 21, 70, "Input",ExpressionUUID->"b4cb63a2-4827-4299-9b4a-c68d7526bf5e",
 CellID->1155092402],
Cell[36986, 985, 306, 8, 70, "Output",ExpressionUUID->"6be09104-49f6-44d5-98da-105750b0b7de",
 CellID->343817116]
}, Open  ]],
Cell[37307, 996, 222, 4, 70, "TechNoteText",ExpressionUUID->"3e147784-9be2-4ebf-bfee-12a3bda809e4",
 CellID->1311209471],
Cell[37532, 1002, 696, 20, 70, "Input",ExpressionUUID->"11832e15-7e01-4c99-bc7b-08e72f1eb64e",
 CellID->151923758]
}, Open  ]],
Cell[CellGroupData[{
Cell[38265, 1027, 105, 1, 70, "Subsection",ExpressionUUID->"c4a33c59-5a39-4403-aec6-cad1f0132482",
 CellID->768952789],
Cell[CellGroupData[{
Cell[38395, 1032, 1037, 27, 70, "Input",ExpressionUUID->"7e91d6cd-d75d-4a9b-b4bc-976827d5b3f8",
 CellID->1608604657],
Cell[39435, 1061, 5018, 92, 70, "Output",ExpressionUUID->"575b9d18-939e-4aab-84e5-f8ce9f861a91",
 CellID->1585695494]
}, Open  ]],
Cell[CellGroupData[{
Cell[44490, 1158, 1040, 27, 70, "Input",ExpressionUUID->"8d7e8261-9c6b-4ea0-bce3-9e599fddfe7a",
 CellID->60442629],
Cell[45533, 1187, 6047, 108, 70, "Output",ExpressionUUID->"9be2df84-b372-44aa-b4a8-cdc97545d609",
 CellID->1536105691]
}, Open  ]],
Cell[51595, 1298, 968, 29, 70, "Input",ExpressionUUID->"a5df3159-ea48-496e-98b3-2743ebcc9a83",
 CellID->1026929483],
Cell[CellGroupData[{
Cell[52588, 1331, 1310, 36, 70, "Input",ExpressionUUID->"b1fdc3d8-e759-4716-8520-d3e9ebaef8c5",
 CellID->1092986670],
Cell[53901, 1369, 6101, 109, 70, "Output",ExpressionUUID->"aedbaf10-b712-4f02-870f-624ce562c18e",
 CellID->139328985]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60063, 1485, 122, 1, 70, "TechNoteSection",ExpressionUUID->"75cf0059-7e18-49c2-8dd1-769c03bc055f",
 CellID->75111769],
Cell[60188, 1488, 158, 2, 70, "TechNoteMathCaption",ExpressionUUID->"83d9605a-2b5d-435d-a369-13f48e492e48",
 CellID->1813517192],
Cell[60349, 1492, 181, 4, 70, "Input",ExpressionUUID->"c81dbba7-4986-4bde-ae82-fe8ec1df5692",
 CellID->370649814],
Cell[60533, 1498, 1097, 30, 70, "Input",ExpressionUUID->"81116443-8d52-47bc-9491-f81f85288335",
 CellID->1624746193],
Cell[61633, 1530, 135, 1, 70, "TechNoteMathCaption",ExpressionUUID->"dc90aad4-a17d-48b2-90c1-8fb050e057cd",
 CellID->2103269434],
Cell[CellGroupData[{
Cell[61793, 1535, 205, 5, 70, "Input",ExpressionUUID->"09b57423-9685-449e-9fb6-23650c16ee95",
 CellID->1956082550],
Cell[62001, 1542, 3710, 87, 70, "Output",ExpressionUUID->"dccb9d6e-870e-4081-98de-8026c868b36c",
 CellID->323151418]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65760, 1635, 115, 1, 70, "TechNoteSection",ExpressionUUID->"87fa74ae-b7bf-4a80-ac97-7a4341e8bf1a",
 CellID->1684028550],
Cell[CellGroupData[{
Cell[65900, 1640, 115, 1, 70, "Subsection",ExpressionUUID->"d15a6ae6-c6bb-4fbf-9952-12b4070cea08",
 CellID->372963104],
Cell[CellGroupData[{
Cell[66040, 1645, 453, 12, 70, "Input",ExpressionUUID->"873b3182-3e61-43b2-a74e-7177a999fa51",
 CellID->1836026386],
Cell[66496, 1659, 5323, 125, 70, "Output",ExpressionUUID->"601009ec-ade1-4aef-8eb1-129c5bc27067",
 CellID->331544561]
}, Open  ]],
Cell[71834, 1787, 509, 14, 70, "Input",ExpressionUUID->"d5c432fb-f8ab-4647-8ca8-612502718533",
 CellID->1331466339],
Cell[72346, 1803, 418, 13, 70, "Input",ExpressionUUID->"f99bd579-7d28-4dbb-a81e-80124bf9cd54",
 CellID->1805190685],
Cell[72767, 1818, 286, 8, 70, "Input",ExpressionUUID->"acef922d-a4c0-4f3b-be58-4e28b116c4dd",
 CellID->2017713712],
Cell[73056, 1828, 2717, 71, 70, "Input",ExpressionUUID->"24275212-9eb4-492e-b140-b0d810e088d8",
 CellID->450103983],
Cell[CellGroupData[{
Cell[75798, 1903, 162, 3, 70, "Input",ExpressionUUID->"988c2c0b-fd09-48b8-8311-7cae98bc85ac",
 CellID->248896434],
Cell[CellGroupData[{
Cell[75985, 1910, 116, 1, 70, "EchoTiming",ExpressionUUID->"edc1c1a2-25fa-43c7-995d-0dc88ec5a974",
 CellID->1825387052],
Cell[76104, 1913, 608, 18, 70, "Echo",ExpressionUUID->"b8e4e3cc-943a-45ca-81ed-761a1e373d16",
 CellID->328801922]
}, Open  ]],
Cell[76727, 1934, 688, 13, 70, "Output",ExpressionUUID->"06d1ce9c-2010-4b57-83ff-cfb2625b95ed",
 CellID->698479323]
}, Open  ]],
Cell[77430, 1950, 154, 1, 70, "TechNoteText",ExpressionUUID->"e6edcb9f-2516-49ac-9edd-864da7787803",
 CellID->1706189206],
Cell[CellGroupData[{
Cell[77609, 1955, 415, 11, 70, "Input",ExpressionUUID->"4be6f401-6a90-4b76-a3f6-3b45cebd45fe",
 CellID->601893948],
Cell[CellGroupData[{
Cell[78049, 1970, 114, 1, 70, "EchoTiming",ExpressionUUID->"5d58f87f-cd43-4725-91a9-aa2d1553589f",
 CellID->483620126],
Cell[78166, 1973, 599, 17, 70, "Echo",ExpressionUUID->"d24cb55b-fa62-4405-b451-7b0ef4a0a4bd",
 CellID->2125337434],
Cell[78768, 1992, 116, 1, 70, "EchoTiming",ExpressionUUID->"1990595a-3a9b-4043-859c-e129420972cb",
 CellID->2125233859],
Cell[78887, 1995, 562, 16, 70, "Echo",ExpressionUUID->"34b3b7b2-47f1-4e8e-8151-038d087c91b1",
 CellID->1857451309],
Cell[79452, 2013, 116, 1, 70, "EchoTiming",ExpressionUUID->"ad75fc3c-1fc2-405a-804b-57c1e27b6d68",
 CellID->1140328572],
Cell[79571, 2016, 517, 14, 70, "Echo",ExpressionUUID->"3d480b16-668b-405c-8a1a-17aa24a75f55",
 CellID->1358243776],
Cell[80091, 2032, 115, 1, 70, "EchoTiming",ExpressionUUID->"a148ce6f-ff8b-415d-a96f-2a8da9dad9cc",
 CellID->377375778],
Cell[80209, 2035, 526, 15, 70, "Echo",ExpressionUUID->"47a7001c-e570-435a-8f5e-9391a5ce60ab",
 CellID->1035491255],
Cell[80738, 2052, 116, 1, 70, "EchoTiming",ExpressionUUID->"ff9a516e-ce9e-4395-872e-07a5222e1bf7",
 CellID->1353604580],
Cell[80857, 2055, 599, 17, 70, "Echo",ExpressionUUID->"ebbb08a6-5f06-46f0-a52c-9df4a8d82c4d",
 CellID->1737903389]
}, Open  ]],
Cell[81471, 2075, 689, 13, 70, "Output",ExpressionUUID->"f618474c-9ac1-4f1b-8d4a-3f5f7c7dc6ed",
 CellID->1017176076]
}, Open  ]],
Cell[82175, 2091, 148, 1, 70, "TechNoteText",ExpressionUUID->"ca83e6b6-febc-4ab1-bf06-921ba2eae771",
 CellID->1452621094],
Cell[82326, 2094, 261, 7, 70, "Input",ExpressionUUID->"94af7041-c97d-4fc8-bc53-6457f76f6fde",
 CellID->1659547112],
Cell[CellGroupData[{
Cell[82612, 2105, 557, 16, 70, "Input",ExpressionUUID->"5b12f869-1aec-44cb-8674-817fcaa4dbc3",
 CellID->961867375],
Cell[83172, 2123, 2490, 76, 70, "Output",ExpressionUUID->"b5100dd0-4c9e-4dfa-88a2-66d7c6d08169",
 CellID->902383345]
}, Open  ]],
Cell[CellGroupData[{
Cell[85699, 2204, 193, 4, 70, "Input",ExpressionUUID->"dbc90af8-5f48-45f7-b922-153f6d56c9ce",
 CellID->1832052457],
Cell[85895, 2210, 1568, 33, 70, "Output",ExpressionUUID->"cc580135-fb75-419a-a99a-22300e838a6f",
 CellID->1723146043]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87512, 2249, 115, 1, 70, "Subsection",ExpressionUUID->"e374de5d-36d5-41dd-a985-9678a31ffadc",
 CellID->1250334885],
Cell[CellGroupData[{
Cell[87652, 2254, 453, 12, 70, "Input",ExpressionUUID->"cb0fdc16-79fd-4fe7-bf17-afacd437c0d5",
 CellID->1250926300],
Cell[88108, 2268, 8589, 201, 70, "Output",ExpressionUUID->"29ea6b89-15dc-4afc-b59c-66468c5060b8",
 CellID->1592316978]
}, Open  ]],
Cell[96712, 2472, 509, 14, 70, "Input",ExpressionUUID->"c7a868b4-376a-4d8d-86bc-bcc9915e9b0e",
 CellID->1357456234],
Cell[97224, 2488, 418, 13, 70, "Input",ExpressionUUID->"13868baa-c777-46e8-a639-e29d7e07a71d",
 CellID->2048142757],
Cell[97645, 2503, 286, 8, 70, "Input",ExpressionUUID->"298f458f-543e-4b51-aff1-26e3374b000b",
 CellID->1119939136],
Cell[97934, 2513, 2717, 71, 70, "Input",ExpressionUUID->"989b4cde-ab73-4882-8f7f-ac1d303de108",
 CellID->122892797],
Cell[CellGroupData[{
Cell[100676, 2588, 163, 3, 70, "Input",ExpressionUUID->"3e52323e-a5c2-47af-97dc-44e0431dbe0b",
 CellID->1727454412],
Cell[CellGroupData[{
Cell[100864, 2595, 116, 1, 70, "EchoTiming",ExpressionUUID->"d12146bb-a976-4f62-85bf-4a00b3afd920",
 CellID->388310646],
Cell[100983, 2598, 561, 16, 70, "Echo",ExpressionUUID->"1ae0d2b0-bcba-48a7-a978-7acbbcea6acf",
 CellID->134224089]
}, Open  ]],
Cell[101559, 2617, 1042, 19, 70, "Output",ExpressionUUID->"aebf77c1-8b74-4732-b0d2-90ab3e8ba584",
 CellID->1046434473]
}, Open  ]],
Cell[102616, 2639, 154, 1, 70, "TechNoteText",ExpressionUUID->"70e1febb-60ae-4e52-ae94-7feaa43cd894",
 CellID->2052016225],
Cell[CellGroupData[{
Cell[102795, 2644, 416, 11, 70, "Input",ExpressionUUID->"dc6f6be6-f935-4168-9dc0-f0d588eaac60",
 CellID->1796806402],
Cell[CellGroupData[{
Cell[103236, 2659, 117, 1, 70, "EchoTiming",ExpressionUUID->"a8de14b5-1862-4919-89af-81ab8b4906b0",
 CellID->1620696619],
Cell[103356, 2662, 519, 14, 70, "Echo",ExpressionUUID->"866b03c9-c8a3-4a02-b1de-7aabd3e3599d",
 CellID->365496985],
Cell[103878, 2678, 116, 1, 70, "EchoTiming",ExpressionUUID->"ffa216f5-33ff-4fe1-8486-43a5163c8a38",
 CellID->338475932],
Cell[103997, 2681, 620, 18, 70, "Echo",ExpressionUUID->"910cf06f-b433-44f8-8da4-b4c1338a1a18",
 CellID->80808221],
Cell[104620, 2701, 117, 1, 70, "EchoTiming",ExpressionUUID->"ad522a8f-3071-42e4-95c5-079d3bb96b8a",
 CellID->2092271953],
Cell[104740, 2704, 561, 16, 70, "Echo",ExpressionUUID->"ab26a058-1b9c-4596-ae77-0edebd59c136",
 CellID->1917478093],
Cell[105304, 2722, 116, 1, 70, "EchoTiming",ExpressionUUID->"5f88b2fa-d457-4bc5-8730-1c25b0ec8582",
 CellID->892730156],
Cell[105423, 2725, 600, 17, 70, "Echo",ExpressionUUID->"d0b4d060-1ee0-4509-bb3e-d3e0983cfb92",
 CellID->1794973950],
Cell[106026, 2744, 117, 1, 70, "EchoTiming",ExpressionUUID->"4efeaff9-fecc-4853-a408-8230db475075",
 CellID->1703628961],
Cell[106146, 2747, 553, 15, 70, "Echo",ExpressionUUID->"dc7f3709-beed-4dae-aa79-d05089187f37",
 CellID->492482076]
}, Open  ]],
Cell[106714, 2765, 1042, 19, 70, "Output",ExpressionUUID->"9655aa9f-316f-4081-a1ae-d68a18c32a75",
 CellID->744275794]
}, Open  ]],
Cell[107771, 2787, 148, 1, 70, "TechNoteText",ExpressionUUID->"1da6b1fa-b350-4700-bd42-8a0da6394f2d",
 CellID->1364328016],
Cell[107922, 2790, 261, 7, 70, "Input",ExpressionUUID->"73777618-0faa-40d4-8656-6ac3c4593770",
 CellID->1578065893],
Cell[CellGroupData[{
Cell[108208, 2801, 558, 16, 70, "Input",ExpressionUUID->"92a136d7-f6fa-4fe7-999e-76f5d244ddfd",
 CellID->1130423201],
Cell[108769, 2819, 2130, 61, 70, "Output",ExpressionUUID->"985bfbbf-9d8e-45a1-a60c-e42720d692b9",
 CellID->1641248024]
}, Open  ]],
Cell[CellGroupData[{
Cell[110936, 2885, 193, 4, 70, "Input",ExpressionUUID->"877a9ed2-1a99-4dd3-a203-47858fa8d1da",
 CellID->1127982600],
Cell[111132, 2891, 1208, 18, 70, "Output",ExpressionUUID->"e3cd5e91-dfa9-43e7-950d-6ef9efc41705",
 CellID->1405875095]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[112379, 2914, 1382, 34, 70, "TutorialMoreAboutSection",ExpressionUUID->"8a63f198-9a83-4f3e-b0b2-4f9efd2017eb"],
Cell[113764, 2950, 1790, 46, 70, "RelatedTutorialsSection",ExpressionUUID->"c7b3dce1-dafd-4f12-82e2-5e6772a0d8f7"],
Cell[115557, 2998, 1765, 48, 70, "TutorialRelatedLinksSection",ExpressionUUID->"ee3611df-8e84-435d-9104-2031d6a13968"]
}, Open  ]],
Cell[117337, 3049, 78, 0, 70, "FooterCell",ExpressionUUID->"196643a4-34fd-4cf0-8e1a-d33bb474a2fe"]
}
]
*)

(* End of internal cache information *)
