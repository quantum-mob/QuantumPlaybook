(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    461407,      11980]
NotebookOptionsPosition[    441198,      11581]
NotebookOutlinePosition[    443831,      11644]
CellTagsIndexPosition[    443788,      11641]
WindowTitle->Entanglement Distillation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell[
          "QUANTUM MOB/ QUANTUM PLAYBOOK TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "fbd1b5d0-9c8c-44b5-add5-5bd9986a6b33"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "3fcb1a4d-293c-4b0c-a3a6-42ac031f9a0c"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "9de0790b-dbfb-42e5-bb91-115db87ddad4"]
         }],ExpressionUUID->"34f04672-c7fd-4e53-b6df-6d221921d5ff"],
         StripOnInput->False],{
        StyleBox["\"Dyad\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/Dyad"], 
         StyleBox[
          "\"PartialTrace\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/PartialTrace"], 
         StyleBox[
          "\"VonNeumannEntropy\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/VonNeumannEntropy"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "500a7d83-11e3-4e14-8fb5-d0035a61f923"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c2cce9ab-0df9-4c64-bbd8-06ced1580cfc"]
         }],ExpressionUUID->"a1bf8e7c-4e7f-4688-8742-32ae3073977a"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumSpinSystems"], 
         "\"A Quantum Playbook\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/QuantumPlaybook/tutorial/QuantumPlaybook"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "bced6860-a574-4030-81ec-a1463bc2863d"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "879f0100-58b1-4d4e-a0b9-9c75a8f79be6"]
         }],ExpressionUUID->"8671862b-9b79-4578-8681-5b5d2e26dda6"],
         StripOnInput->False],{
        "\"Entanglement Distillation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/QuantumPlaybook/tutorial/\
EntanglementDistillation"], "\"Quantum Information Theory\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationTheory"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "6e946f16-5022-423d-84de-4eceda6f3f9b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "99794991-b202-4bfa-ab87-a43752e333bc"]
         }],ExpressionUUID->"ccb85f0f-770c-48d6-a814-00866f408567"],
         StripOnInput->False],{
        "\"QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation\"" :> 
         None, "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation"], 
         Delimiter, "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/\
QuantumPlaybook/tutorial/EntanglementDistillation.html"], StandardForm]], 
                 "Input", TextClipboardType -> "PlainText"]}, Visible -> 
               False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation" <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f115b3af-4151-4769-b033-508c594768d1"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "91cd8eab-2ca7-49a3-9548-10ee6856e474"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"b7671edd-a9b6-4159-82d5-38f57b45a2f6"],

Cell[CellGroupData[{

Cell["Entanglement Distillation", "TechNoteTitle",
 CellID->1980526771,ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["To Generate Partially Entangled Pairs"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation#\
9608243", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Transformation"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation#\
797821259", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Measurement of Total Pauli Z"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation#\
224262840", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Overall"], 
      "paclet:QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation#\
1248933531", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"2ffede48-6c75-4655-8d62-\
02aa0fc958a2"],

Cell[TextData[{
 "See also Section 7.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (Springer, 2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "6648762d-56e2-458a-bc38-569401efc123"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd"],

Cell[TextData[{
 "Here, we start with a number of ",
 StyleBox["partially",
  FontSlant->"Italic"],
 " entangled pairs and \
\[OpenCurlyDoubleQuote]distills\[CloseCurlyDoubleQuote] a smaller number of \
",
 StyleBox["maximally",
  FontSlant->"Italic"],
 " entangled pairs. This is illustrated in the quantum circuit model."
}], "TechNoteText",
 CellID->444601366,ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["VonNeumannEntropy"]], 
      "paclet:QuantumMob/Q3S/ref/VonNeumannEntropy", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "VonNeumann entropy of a mixed state", "TechNoteTableText",ExpressionUUID->
     "edb04415-527a-488f-bc87-26cf536cd3dc"]},
   {
    TemplateBox[{
      Cell[
       TextData["PartialTrace"]], "paclet:QuantumMob/Q3S/ref/PartialTrace", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Partial trace over some subsystems", "TechNoteTableText",ExpressionUUID->
     "3dfef7b8-445d-4369-abf4-1e0dc9c9556c"]},
   {
    TemplateBox[{
      Cell[
       TextData["Dyad"]], "paclet:QuantumMob/Q3S/ref/Dyad", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Dyadic product of two vectors", "TechNoteTableText",ExpressionUUID->
     "a42dc33d-7165-4ab1-8cfa-bb15b4fa6f2f"]}
  }]], "DefinitionBox",
 CellID->1410604422,ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204"],

Cell["Functions used in this document.", "TechNoteCaption",
 CellID->1956541321,ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da"],

Cell["Make sure that Q3 is loaded.", "TechNoteMathCaption",
 CellID->1329022598,ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3S`\>\"", "]"}]], "Input",
 CellLabel->"In[236]:=",
 CellID->172539488,ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f"],

Cell["\<\
We have two parties Alice (A) and Bob (B). Teddy (T)  is an ancillary \
register to perform a measurement of the total Pauli Z.\
\>", "TechNoteMathCaption",
 CellID->1573161274,ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "B", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[237]:=",
 CellID->768251366,ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41"],

Cell[TextData[{
 "We will start with ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs."
}], "TechNoteMathCaption",
 CellID->1676761233,ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"A", "[", 
    RowBox[{"kk", ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"B", "[", 
    RowBox[{"kk", ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[238]:=",
 CellID->363452503,ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04"],

Cell[TextData[{
 "You need fewer qubits for T, just enough to store a number up to maximum ",
 StyleBox["n",
  FontSlant->"Italic"],
 ". "
}], "TechNoteMathCaption",
 CellID->1432690958,ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ln", "=", 
   RowBox[{"Ceiling", "@", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", 
      RowBox[{"$n", "+", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"Range", "@", "ln"}], ",", "$"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[242]:=",
 CellID->1164469075,ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6"],

Cell[CellGroupData[{

Cell["To Generate Partially Entangled Pairs", "TechNoteSection",
 CellID->9608243,ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b"],

Cell[CellGroupData[{

Cell["A Single Pair", "Subsection",
 CellID->895983480,ExpressionUUID->"58b778a6-05e8-4fc3-9347-97575fdfbaec"],

Cell["\<\
Let us first examine a single pair of partially entangled qubits.\
\>", "TechNoteText",
 CellID->963914888,ExpressionUUID->"ee0d4f6b-5310-42de-a349-486686a0f204"],

Cell["\<\
First, construct a superposition of the two computational basis states  with \
different amplitudes.\
\>", "TechNoteMathCaption",
 CellID->1326468628,ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"A", "@", 
      RowBox[{"{", "1", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[244]:=",
 CellID->424466576,ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, LineBox[{{{0, -1}, {2, -1}}}], 
    InsetBox[
     StyleBox[
      TemplateBox[{"0"},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.16000000000000003`],
      FontWeight->"Light"], {-0.1, -1}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->118.8,
   PlotRange->NCache[{Full, {
       Rational[-3, 2], 
       Rational[-1, 2]}}, {Full, {-1.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3S`$] -> 0|>]], 
   Q3S`Rotation[$CellContext`\[Phi], 
    $CellContext`A[1, 2]]]]], "Output",
 CellLabel->"Out[245]=",
 CellID->345470920,ExpressionUUID->"ab45b13c-29c2-4612-80e1-367c4c938c97"]
}, Open  ]],

Cell[TextData[{
 "Parameter \[Phi] tunes the two amplitudes, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "0"], "=", 
    RowBox[{"cos", "(", 
     RowBox[{"\[Phi]", "/", "2"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "c3de4684-dd58-4b2b-885b-a2fb615a8a72"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], "=", 
    RowBox[{"sin", "(", 
     RowBox[{"\[Phi]", "/", "2"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "c2b7fbee-ee68-44f3-86b7-f6ade549eede"],
 ", in the superposition."
}], "TechNoteMathCaption",
 CellID->1200711519,ExpressionUUID->"b775cd35-77ca-43a9-8064-bb4eb73e9f22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "qc", "]"}], "//", "ExpandAll"}]], "Input",
 CellLabel->"In[246]:=",
 CellID->1176269506,ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[246]=",
 CellID->594998522,ExpressionUUID->"24176084-ba69-4561-a2cd-c0d425da5f60"]
}, Open  ]],

Cell["\<\
Then, by applying the CNOT gate, you can create a partially entangled pair.\
\>", "TechNoteMathCaption",
 CellID->1153639981,ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], ",", 
       RowBox[{"B", "[", "1", "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], ",", 
      RowBox[{"B", "[", "1", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[247]:=",
 CellID->1509698055,ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -1}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.10666666666666667`],
       FontWeight->"Light"], {-0.1, -2}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -1.4}}], InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->154.79999999999998`,
   PlotRange->NCache[{Full, {
       Rational[-5, 2], 
       Rational[-1, 2]}}, {Full, {-2.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`B[1, Q3S`$] -> 0|>]], 
   Q3S`Rotation[$CellContext`\[Phi], 
    $CellContext`A[1, 2]], 
   Q3S`CNOT[{
      $CellContext`A[1, Q3S`$]} -> {1}, {
     $CellContext`B[1, Q3S`$]}]]]], "Output",
 CellLabel->"Out[247]=",
 CellID->1015107827,ExpressionUUID->"62daf495-5ea3-42ae-8970-28a75ffa29d0"]
}, Open  ]],

Cell[TextData[{
 "Eventually, we see that the parameter \[Phi] tunes the extent of \
entanglement (with ",
 Cell[BoxData[
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Pi]", "/", "2"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7aa2bbed-5173-46ab-bdc5-9d38cc394a89"],
 " corresponds to the maximal entanglement)."
}], "TechNoteMathCaption",
 CellID->424047388,ExpressionUUID->"70773f4c-3264-40dc-8059-b8b90e1b9b1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[248]:=",
 CellID->2084847387,ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`B[1, Q3S`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`B[1, Q3S`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[248]=",
 CellID->1139705760,ExpressionUUID->"4cd3cc77-5a72-4ec0-8e78-424f383ae11b"]
}, Open  ]],

Cell["\<\
Examine the reduced density matrix for the first qubit to check that the \
above state is partial entangled.\
\>", "TechNoteMathCaption",
 CellID->1376812949,ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialTrace", "[", 
      RowBox[{"out", ",", 
       RowBox[{"B", "[", "1", "]"}]}], "]"}], "//", "ExpToTrig"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "rho", "]"}], "//", "ExpToTrig"}], "//", 
   "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[249]:=",
 CellID->1003824959,ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        FractionBox["\[Phi]", "2"], "]"}], "2"], "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]]^2, 
       Sin[Rational[1, 2] $CellContext`\[Phi]]^2}}]]]]], "Output",
 CellLabel->"Out[250]//MatrixForm=",
 CellID->1475663078,ExpressionUUID->"45db5982-d3b8-4857-9fd1-6d491452e91e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiple Pairs", "Subsection",
 CellID->443447814,ExpressionUUID->"5b28959a-a2ff-4e73-bec9-da1693954f99"],

Cell[TextData[{
 "Now, we consider ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs with each pair in the state described above. Let \
us take a look at the explicit expression for the ",
 StyleBox["n",
  FontSlant->"Italic"],
 " partially entangled pairs. Here, ",
 ButtonBox["OTimes",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/OTimes"],
 "  is used just for better readability, and you can replace it with ",
 ButtonBox["CircleTimes",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/CircleTimes"],
 " (\[CircleTimes]) or ",
 ButtonBox["Multiply",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/multiply"],
 " to get exactly the same result."
}], "TechNoteText",
 CellID->2081747837,ExpressionUUID->"f3d9c9d2-149a-43bc-b609-cd9dd58fef1c"],

Cell["\<\
Repeating the above procedure for other pairs, generate as many partially \
entangled pairs as  you like. In this particular example, we prepare four \
pairs.\
\>", "TechNoteMathCaption",
 CellID->70875601,ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc0", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "AA", "]"}], ",", 
    RowBox[{"Ket", "[", "BB", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotation", "[", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"A", "[", 
       RowBox[{"kk", ",", "2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"ReleaseHold", "@", 
      RowBox[{"Thread", "@", 
       RowBox[{
        RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
        RowBox[{"AA", ",", "BB"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[251]:=",
 CellID->170713811,ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}, {{0, -6}, {6, -6}}, {{0, -7}, {6, -7}}, {{0, -8}, {
     6, -8}}, {{0, -9}, {6, -9}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.05333333333333334],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-19, 2], 
       Rational[-1, 2]}}, {Full, {-9.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], {
    Q3S`Rotation[$CellContext`\[Phi], 
     $CellContext`A[1, 2]], 
    Q3S`Rotation[$CellContext`\[Phi], 
     $CellContext`A[2, 2]], 
    Q3S`Rotation[$CellContext`\[Phi], 
     $CellContext`A[3, 2]], 
    Q3S`Rotation[$CellContext`\[Phi], 
     $CellContext`A[4, 2]]}, 
   Q3S`CNOT[{
      $CellContext`A[1, Q3S`$]} -> {1}, {
     $CellContext`B[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[2, Q3S`$]} -> {1}, {
     $CellContext`B[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[3, Q3S`$]} -> {1}, {
     $CellContext`B[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[4, Q3S`$]} -> {1}, {
     $CellContext`B[4, Q3S`$]}], "Invisible" -> $CellContext`A[
     Rational[9, 2]]]]], "Output",
 CellLabel->"Out[251]=",
 CellID->238783619,ExpressionUUID->"7f29f2a1-9388-44bd-aeae-3be85ade472a"]
}, Open  ]],

Cell["\<\
Expanding it, one gets various terms, each with identical parts on Alice\
\[CloseCurlyQuote]s and Bob\[CloseCurlyQuote]s side.\
\>", "TechNoteMathCaption",
 CellID->1017693123,ExpressionUUID->"115db23e-3de8-43d4-93b5-3d0b58b21815"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ProductForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{"AA", ",", "BB"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[252]:=",
 CellID->1372770070,ExpressionUUID->"3d9c0a09-4f34-426d-a193-2139db7333ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "3"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "4"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"Cot", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      1, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
      "\"\[CircleTimes]\"", 
      TemplateBox[{
        TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
     "RowDefault"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}]], "Output",
 CellLabel->"Out[253]=",
 CellID->743762127,ExpressionUUID->"a5aba9a9-7f73-4682-8c85-87c71867cdd6"]
}, Open  ]],

Cell[TextData[{
 "If Alice (or Bob) measures the total ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "017f7821-c342-4df3-982d-d6d0bd7d47bb"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", "=", 
    RowBox[{
     SubscriptBox["Z", "1"], "+", 
     SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
     SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "84941348-b9b7-4609-83cd-e2d2981c0c8f"],
 " on her qubits (see below), then the possible outcomes are  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"m", "=", "0"}], ",", "1", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"67ffbfc3-1609-4fc6-96b2-42b244c8364f"],
 " and the corresponding probabilities are given by the following formula."
}], "TechNoteText",
 CellID->1171545641,ExpressionUUID->"aadce766-e449-4160-83e8-dfd4254d70d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prb", "[", 
   RowBox[{"\[Phi]_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "/", "2"}], "]"}], "^", "2"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"$n", ",", "m"}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"$n", "-", "m"}], ")"}]}], 
     RowBox[{"p", "^", "m"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[254]:=",
 CellID->225912086,ExpressionUUID->"70e2f9d9-c8a9-4ec3-b730-fc7f9b5be262"],

Cell[TextData[{
 "For fixed ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]],ExpressionUUID->
  "554d793c-a187-40c8-8cc8-64bd78c62e0e"],
 ", the probability distribution looks like the following plot. The highest \
probability is for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", 
    RowBox[{"n", "\[VeryThinSpace]", 
     RowBox[{
      SuperscriptBox["sin", "2"], "(", 
      RowBox[{"\[Phi]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"cd570e65-4039-42d1-b090-85903385f781"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "5f1b987d-3402-4729-9ff8-4e71bb04fadb"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Phi]", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "3"}]}]}], TraditionalForm]],ExpressionUUID->
  "bc8bc1d7-9967-456d-81a6-6bdc06c2d038"],
 ")."
}], "TechNoteText",
 CellID->428998052,ExpressionUUID->"2c4b1d54-f870-458a-afbf-8eaad838da15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BarChart", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"prb", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"Pi", "/", "3"}]}], ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "$n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ChartLabels", "->", 
    RowBox[{"Range", "[", "$n", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Axes", "->", "None"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<m\>\"", ",", "\"\<Probability\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[255]:=",
 CellID->153341506,ExpressionUUID->"f9b6efeb-5191-4ff5-afc2-4239e623f4ea"],

Cell[BoxData[
 GraphicsBox[{
   {Opacity[0], 
    PointBox[{{0.0195484340859432, 0.}, {4.902403495994173, 0.}}]}, {{}, 
    {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
     0.6719999999999999], Thickness[Small]}], 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{0.5487982520029133, 0.}, {1.4512017479970867`, 
             0.046875}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{59.18316673761143, 95.95219414932298}, {
            32.26778719973799, 46.103959456534064`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[3, 64]]& ,
         TagBoxNote->"3/64"],
        StyleBox[
         FractionBox["3", "64"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[3, 64], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{1.5487982520029133`, 0.}, {2.4512017479970867`, 
             0.2109375}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{99.37475240046854, 
            136.14377981218007`}, {-14.408815699048283`, 
            46.103959456534064`}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[27, 128]]& ,
         TagBoxNote->"27/128"],
        StyleBox[
         FractionBox["27", "128"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[27, 128], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{2.5487982520029133`, 0.}, {3.4512017479970867`, 
             0.421875}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{139.56633806332565`, 
            176.33536547503718`}, {-74.42159085463064, 46.10395945653406}}],
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[27, 64]]& ,
         TagBoxNote->"27/64"],
        StyleBox[
         FractionBox["27", "64"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[27, 64], {}], "Tooltip"]& ]}, 
     {RGBColor[0.982864, 0.7431472, 0.3262672], EdgeForm[{Opacity[
      0.6719999999999999], Thickness[Small]}], 
      TagBox[
       TooltipBox[
        TagBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            
            RectangleBox[{3.5487982520029133`, 0.}, {4.451201747997087, 
             0.31640625}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{179.75792372618275`, 
            216.5269511378943}, {-44.415203276839456`, 46.103959456534064`}}],
          
          "DelayedMouseEffectStyle"],
         StatusArea[#, 
          Rational[81, 256]]& ,
         TagBoxNote->"81/256"],
        StyleBox[
         FractionBox["81", "256"], {}, StripOnInput -> False]],
       Annotation[#, 
        Style[
         Rational[81, 256], {}], "Tooltip"]& ]}}, {}, {}}, {}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0.0195484340859432, 0.},
  AxesStyle->{},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Identity[
       Part[#, 1]], 
      Identity[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"m\"", HoldForm], TraditionalForm], None}},
  FrameStyle->{},
  FrameTicks->{{Automatic, Automatic}, {{{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {1., 
       FormBox["1", TraditionalForm], 0}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox["2", TraditionalForm], 0}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox["3", TraditionalForm], 0}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox["4", TraditionalForm], 0}}, {{1., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {2., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {3., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}, {4., 
       FormBox[
        TemplateBox[{0}, "Spacer1"], TraditionalForm], {0.004, 0}}}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Automatic,
  PlotRange->{{All, All}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {None, 
     Scaled[0.05]}},
  Ticks->{None, Automatic}]], "Output",
 CellLabel->"Out[255]=",
 CellID->667441612,ExpressionUUID->"8417e826-0a52-47ce-81d8-e719e32a5fb5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement of Total Pauli Z", "TechNoteSection",
 CellID->224262840,ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb"],

Cell[TextData[{
 "How can we actually measure ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], ":=", 
     RowBox[{
      SubscriptBox["Z", "1"], "+", 
      SubscriptBox["Z", "2"], "+", "\[Ellipsis]", "+", 
      SubscriptBox["Z", "n"]}]}], TraditionalForm]],ExpressionUUID->
   "7bbcced6-851c-44a9-9be8-484a27dc4540"]],ExpressionUUID->
   "69787956-9626-4928-a81f-683e7deac14b"]],ExpressionUUID->
  "83d30246-6808-479b-a079-93c3675b04f1"],
 "on Bob's (or, equivalently, Alice's) qubits."
}], "TechNoteText",
 CellID->1184887274,ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976"],

Cell[TextData[{
 "To specific, we assume ",
 Cell[BoxData[
  RowBox[{"\[Phi]", "=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "3"}]}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "aff57575-790e-4529-943e-b677419f013d"],
 " from now on."
}], "TechNoteMathCaption",
 CellID->1611641769,ExpressionUUID->"2190b60b-1c08-44ad-91b6-6d3198502349"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]", "=", 
  RowBox[{"2", 
   RowBox[{"Pi", "/", "3"}]}]}]], "Input",
 CellLabel->"In[256]:=",
 CellID->984885170,ExpressionUUID->"e30d9019-04c2-4dd3-a672-bc7be9efeebf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]"}], "3"]], "Output",
 CellLabel->"Out[256]=",
 CellID->1748576565,ExpressionUUID->"4d6525d8-225b-41c6-9015-4265721cc354"]
}, Open  ]],

Cell["This is a tiny utility function for convenience.", "TechNoteMathCaption",
 CellID->145578351,ExpressionUUID->"080e79ed-ca53-459c-b818-d710af35f15c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bundle", "[", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"bundle", "[", "c", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "$n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bundle", "[", "c_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"log", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"c", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CNOT", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"T", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"k", "-", "1"}], "]"}]}], ",", 
          RowBox[{"B", "[", "c", "]"}]}], "]"}], ",", 
        RowBox[{"T", "[", "k", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "log", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[257]:=",
 CellID->1429019289,ExpressionUUID->"6cc38884-16f5-4c2e-bb3e-51700d3b779e"],

Cell[TextData[{
 "The value of ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    SubscriptBox["Z", "tot"], TraditionalForm]],ExpressionUUID->
   "8e95616a-a134-4201-96bb-ec4c490eab26"]],ExpressionUUID->
   "7410e034-03a5-456f-85a8-e2c04028fdaf"]],ExpressionUUID->
  "516334db-a950-41ea-8345-2cd7700a78c6"],
 " is stored on Teddy's register."
}], "TechNoteMathCaption",
 CellID->2075092591,ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "TT", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"bundle", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"B", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[259]:=",
 CellID->2010699221,ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}, {{0, -6}, {9, -6}}, {{0, -7}, {9, -7}}, {{0, -8}, {
     9, -8}}}], {InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -6}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -7}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
      StyleBox[
       TemplateBox[{"0"},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.035555555555555556`],
       FontWeight->"Light"], {-0.1, -8}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -6}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -6}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -6}, {1.2666666666666666`, -6}}, {{
         1, -6.266666666666667}, {1, -5.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}, {2, -7}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -6}, 0.09], {CircleBox[{2, -7}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -7}, {2.2666666666666666`, -7}}, {{
         2, -7.266666666666667}, {2, -6.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -6}, {4, -7}}], DiskBox[{4, -3}, 0.09], 
     DiskBox[{4, -6}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}, {
     LineBox[{{5, -3}, {5, -6}}], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -6}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -6}, {5.266666666666667, -6}}, {{
         5, -6.266666666666667}, {5, -5.733333333333333}}}]}}, {
     LineBox[{{6, -4}, {6, -6}, {6, -7}, {6, -8}}], DiskBox[{6, -4}, 0.09], 
     DiskBox[{6, -6}, 0.09], 
     DiskBox[{6, -7}, 0.09], {CircleBox[{6, -8}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -8}, {6.266666666666667, -8}}, {{
         6, -8.266666666666667}, {6, -7.733333333333333}}}]}}, {
     LineBox[{{7, -4}, {7, -6}, {7, -7}}], DiskBox[{7, -4}, 0.09], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -7}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -7}, {7.266666666666667, -7}}, {{
         7, -7.266666666666667}, {7, -6.733333333333333}}}]}}, {
     LineBox[{{8, -4}, {8, -6}}], 
     DiskBox[{8, -4}, 0.09], {CircleBox[{8, -6}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -6}, {8.266666666666667, -6}}, {{
         8, -6.266666666666667}, {8, -5.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->370.8,
   PlotRange->NCache[{Full, {
       Rational[-17, 2], 
       Rational[-1, 2]}}, {Full, {-8.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3S`$] -> 0, $CellContext`T[2, Q3S`$] -> 
      0, $CellContext`T[3, Q3S`$] -> 0|>]], 
   Q3S`CNOT[{
      $CellContext`B[1, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$], 
      $CellContext`T[2, Q3S`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellLabel->"Out[259]=",
 CellID->1313508407,ExpressionUUID->"a48c7ead-8786-4440-a374-a6f9db9bc017"]
}, Open  ]],

Cell["\<\
Let us check that the above quantum circuit indeed gives the sum of the bit \
values of the Bob\[CloseCurlyQuote]s qubits.\
\>", "TechNoteText",
 CellID->325402613,ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc1", "**", "in"}]}], ";"}]}], "Input",
 CellLabel->"In[260]:=",
 CellID->1548351429,ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
    RowBox[{"Reverse", "/@", 
     RowBox[{"Through", "[", 
      RowBox[{"out", "[", "TT", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"SimpleForm", "[", "in", "]"}], "->", "sum"}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellLabel->"In[262]:=",
 CellID->2083116504,ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "0"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"0", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "1"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "0", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "2"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "0", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "1", "0"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", "3"}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            TemplateBox[{"1", "1", "1", "1"}, "RowDefault"]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", "4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[263]//TableForm=",
 CellID->95040948,ExpressionUUID->"713b775d-c91d-47eb-9d72-9d6f7709437c"]
}, Open  ]],

Cell[TextData[{
 "In actual situation, one must perform the measurement on Teddy's register \
in the computational basis. The measurement outcome refers to the value of ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["Z",
    FontSlant->"Italic"], "tot"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e5d11078-7437-4a42-aacf-d2a38b562134"],
 "."
}], "TechNoteMathCaption",
 CellID->1803890242,ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"$n", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], ",", 
       RowBox[{"T", "[", "5", "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    "qc0", ",", "\"\<Separator\>\"", ",", "qc1", ",", "\"\<Spacer\>\"", ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"Range", "@", "ln"}], ",", "3"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[264]:=",
 CellID->817515057,ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{16, -11}, {17, -11}}, {{16, -12}, {17, -12}}, {{16, -13}, {
      17, -13}}}]}, 
    LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
     0, -4}, {17, -4}}, {{0, -6}, {17, -6}}, {{0, -7}, {17, -7}}, {{0, -8}, {
     17, -8}}, {{0, -9}, {17, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
     16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -11}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -12}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -13}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.018823529411764708`],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.023529411764705882`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
        6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
         7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
     LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
     DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
         8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
     LineBox[{{9, -7}, {9, -11}}], 
     DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
         9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
     LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
     DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
         10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
     LineBox[{{11, -8}, {11, -11}}], 
     DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
      LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
         11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
     LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
     DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
     DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
         12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
     LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
     DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
      LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
         13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
     LineBox[{{14, -9}, {14, -11}}], 
     DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
      LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
         14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
       LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
        15.6, -11.4}}]}, 
      CircleBox[{16, -11.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
       LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
        15.6, -12.4}}]}, 
      CircleBox[{16, -12.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
       LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
        15.6, -13.4}}]}, 
      CircleBox[{16, -13.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->658.8000000000001,
   PlotRange->NCache[{Full, {
       Rational[-29, 2], 
       Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3S`$] -> 0, $CellContext`T[2, Q3S`$] -> 
      0, $CellContext`T[3, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], {
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[1, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[2, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[3, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[4, 2]]}, 
   Q3S`CNOT[{
      $CellContext`A[1, Q3S`$]} -> {1}, {
     $CellContext`B[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[2, Q3S`$]} -> {1}, {
     $CellContext`B[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[3, Q3S`$]} -> {1}, {
     $CellContext`B[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[4, Q3S`$]} -> {1}, {
     $CellContext`B[4, Q3S`$]}], "Separator", 
   Q3S`CNOT[{
      $CellContext`B[1, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$], 
      $CellContext`T[2, Q3S`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], "Spacer", 
   Q3S`Measurement[{
     $CellContext`T[1, 3], 
     $CellContext`T[2, 3], 
     $CellContext`T[3, 3]}], "Invisible" -> {
     $CellContext`A[
      Rational[9, 2]], 
     $CellContext`B[
      Rational[9, 2]], 
     $CellContext`T[5]}, "Invisible" -> $CellContext`A[
     Rational[9, 2]], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellLabel->"Out[264]=",
 CellID->876300292,ExpressionUUID->"283086ee-b07b-45ea-8fad-b518201ec1a8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformation", "TechNoteSection",
 CellID->797821259,ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83"],

Cell[TextData[{
 "The post-measurement state is spread over the four qubits of Alice's and \
Bob's registers, respectively. One has to transform it into a smaller number \
of pairs. Here, we assume that the measurement outcome is ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
   "72baf89f-33d0-460c-acf5-c2a7015f20ba"]],ExpressionUUID->
   "632d69de-81c9-4edd-96a7-4c1babad198f"]],ExpressionUUID->
  "218e5a54-79ea-467a-b69a-a57d59b2b2af"],
 ", corresponding to two maximally entangled pairs. Note that  measurement \
outcome ",
 Cell[BoxData[Cell[TextData[Cell[BoxData[
   FormBox[
    RowBox[{
     SubscriptBox["Z", "tot"], "=", "1"}], TraditionalForm]],ExpressionUUID->
   "9abc87de-4426-4b24-b12c-ded2687d2702"]],ExpressionUUID->
   "49dd4280-2715-476f-b8f5-956e7dfd0af7"]],ExpressionUUID->
  "baeb783c-7575-4851-b014-40a1f4b48f75"],
 "also leads to two maximally entangled pairs since ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["Binomial"]], "paclet:ref/Binomial"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{"4", ",", "1"}], "]"}], "==", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["Binomial"]], "paclet:ref/Binomial"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{"4", ",", "3"}], "]"}], "==", "4"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3e5f089e-fb83-4aba-b73a-a8b4705d9be5"],
 "."
}], "TechNoteText",
 CellID->695573627,ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3"],

Cell["\<\
To get the unitary transformation on Alice's side, we first rearrange the \
computational basis to get a new basis  \
\>", "TechNoteText",
 CellID->1699338655,ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0111"},
       "Ket"], ",", 
      TemplateBox[{"1011"},
       "Ket"], ",", 
      TemplateBox[{"1101"},
       "Ket"], ",", 
      TemplateBox[{"1110"},
       "Ket"], ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "5"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "16"]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "0575b6b1-6272-4b68-836f-6ee56a50e16c"],
 ","
}], "TechNoteText",
 CellID->1399753132,ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Alpha]", "k"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "c1f84491-5da5-457e-9c46-218a70abd252"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "5"}], ",", "\[Ellipsis]", ",", "16"}], 
   TraditionalForm]],ExpressionUUID->"e1c1b579-e443-40ef-8517-29c30a6ae8c2"],
 ") are the computational basis states with total spin not equal to 3. Next, \
consider still another basis\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalA]", "'"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "5", "\[Prime]"]},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        SubsuperscriptBox["\[Alpha]", "16", "\[Prime]"]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "a86f7946-580c-4849-a46c-efc49e376300"],
 ","
}], "TechNoteText",
 CellID->2115020286,ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538"],

Cell[TextData[{
 "where we have put a semicolon ';' to indicate the first two qubits to which \
encode Alice\[CloseCurlyQuote]s part of the maximally entangled states. Then, \
the required unitary transformation corresponds to the basis change from ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "015bfae9-be74-4c6b-b696-6f186408339e"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "b84a5cbc-9ee0-4cb9-b29f-3253c7650534"],
 ". That is to say, the unitary transformation is given by "
}], "TechNoteText",
 CellID->1996621658,ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{"00", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"0111"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"01", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1011"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"10", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1101"},
       "Bra"]}], "+", 
     RowBox[{
      TemplateBox[{
        RowBox[{"11", ";", "00"}]},
       "Ket"], 
      TemplateBox[{"1110"},
       "Bra"]}], "+", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "=", "5"}], "16"], 
      TemplateBox[{
        SubsuperscriptBox["a", "k", "\[Prime]"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["\[Alpha]", "k"]},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "87c6ec4a-9ab1-4901-91e5-e79b83299c56"],
 "."
}], "TechNoteText",
 CellID->640737984,ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565"],

Cell[TextData[{
 "The unitary transformation on Bob's register may be obtained in the same \
manner, where we denote the rearranged bases by ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "4130a2b7-34a8-4112-95e4-2c130bfd0acb"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "485c69e4-a797-4631-9f76-ad2cf6108f14"]
}], "TechNoteText",
 CellID->1266994926,ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32"],

Cell[CellGroupData[{

Cell["Method 1: Using Dyad", "Subsection",
 CellID->1145574102,ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533"],

Cell["\<\
These are the computational bases for Alice's and Bob's registers, \
respectively.\
\>", "TechNoteMathCaption",
 CellID->920704413,ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bsA", "=", 
  RowBox[{"Basis", "[", "AA", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bsB", "=", 
  RowBox[{"Basis", "[", "BB", "]"}]}]}], "Input",
 CellLabel->"In[265]:=",
 CellID->989436024,ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[265]=",
 CellID->1303143257,ExpressionUUID->"eac09c35-cf1f-4c5a-a14c-6c6b798c8094"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[266]=",
 CellID->1890488293,ExpressionUUID->"c2030a24-e116-4dbb-a1ff-2c670100b178"]
}, Open  ]],

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalA]", TraditionalForm]],ExpressionUUID->
  "b8e0af21-77d0-4e28-a7b1-20ad5f9f567e"],
 " and ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "a6577184-6759-4344-b8b2-7fcc452275a1"],
 " for Alice's and Bob's registers, respectively."
}], "TechNoteMathCaption",
 CellID->284257392,ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"PadLeft", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", "3"}], "]"}], ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"AA", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sppB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"BB", "->", "#"}], "]"}], "&"}], "/@", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sppA", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"sppA", ",", 
    RowBox[{"Sort", "@", 
     RowBox[{"Complement", "[", 
      RowBox[{"bsA", ",", "sppA"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sppB", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"sppB", ",", 
    RowBox[{"Sort", "@", 
     RowBox[{"Complement", "[", 
      RowBox[{"bsB", ",", "sppB"}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[267]:=",
 CellID->576306453,ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[270]=",
 CellID->1527058845,ExpressionUUID->"207de498-38e6-4a12-8aa7-89277ca21014"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[271]=",
 CellID->700942618,ExpressionUUID->"6457fef7-19d7-40e9-8ba6-70cc74b9d452"]
}, Open  ]],

Cell[TextData[{
 "These are the bases ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", "'"}], TraditionalForm]],ExpressionUUID->
  "5671d54f-e4c8-4db0-8cc0-46fbb620be12"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "'"}], TraditionalForm]],ExpressionUUID->
  "2ec593f4-ee41-4645-9025-db89c3b29d3e"],
 " for Alice's and Bob's registers, respectively."
}], "TechNoteMathCaption",
 CellID->1601110815,ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"newA", "=", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"A", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"KetRegulate", "[", 
      RowBox[{"#", ",", "AA"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newB", "=", 
   RowBox[{
    RowBox[{"Basis", "[", 
     RowBox[{"B", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"KetRegulate", "[", 
      RowBox[{"#", ",", "BB"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"newA", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"newA", ",", 
    RowBox[{"Sort", "@", 
     RowBox[{"Complement", "[", 
      RowBox[{"bsA", ",", "newA"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"newB", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"newB", ",", 
    RowBox[{"Sort", "@", 
     RowBox[{"Complement", "[", 
      RowBox[{"bsB", ",", "newB"}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[272]:=",
 CellID->38369270,ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[274]=",
 CellID->225712167,ExpressionUUID->"d2e9cf5b-5d68-4da3-9fb1-2e8794bb7f7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]}], 
  "}"}]], "Output",
 CellLabel->"Out[275]=",
 CellID->1088270167,ExpressionUUID->"9ea22c61-2989-4e9d-b6b8-6c7addea4f88"]
}, Open  ]],

Cell["\<\
Finally, the unitary transformation is constructed as prescribed above.\
\>", "TechNoteMathCaption",
 CellID->2067394127,ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"trsA", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "AA"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newA", ",", "sppA"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"trsB", "=", 
  RowBox[{"Total", "@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyad", "[", 
       RowBox[{"#1", ",", "#2", ",", "BB"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"newB", ",", "sppB"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[276]:=",
 CellID->1604828370,ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`A[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`A[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
        1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
     1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
     1|>]]}]], "Output",
 CellLabel->"Out[276]=",
 CellID->47909730,ExpressionUUID->"d117cbab-ea64-4079-8609-6cc744b17afa"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Ket"], 
      Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]], 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`B[1, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`B[2, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["1", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]}, "Bra"], 
      Bra[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
        1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]]},
    "RowDefault"],
   Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
     1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
     1|>]]}]], "Output",
 CellLabel->"Out[277]=",
 CellID->2059948132,ExpressionUUID->"2b97a62d-f933-4c9c-b267-2ba0a6c654e4"]
}, Open  ]],

Cell["\<\
By construction, the unitary transformations are just permutation, which is \
clear from their matrix representations.\
\>", "TechNoteMathCaption",
 CellID->861429414,ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Matrix", "[", "trsA", "]"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "trsB", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[278]:=",
 CellID->1196447817,ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellLabel->"Out[278]//MatrixForm=",
 CellID->307853044,ExpressionUUID->"1c22eb30-8454-419d-9330-349f47a2e2e6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{8}, {
       1}, {2}, {3}, {12}, {4}, {5}, {6}, {14}, {7}, {9}, {10}, {15}, {11}, {
       13}, {16}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellLabel->"Out[279]//MatrixForm=",
 CellID->798004885,ExpressionUUID->"be7ba98e-130c-4982-aaf2-6156f94f6223"]
}, Open  ]],

Cell["Check that they are indeed unitary transformations.", \
"TechNoteMathCaption",
 CellID->93724021,ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsA", "]"}], "**", "trsA"}], "//", 
  "Elaborate"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dagger", "[", "trsB", "]"}], "**", "trsB"}], "//", 
  "Elaborate"}]}], "Input",
 CellLabel->"In[280]:=",
 CellID->428846345,ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[280]=",
 CellID->473646905,ExpressionUUID->"90704de5-2cc3-41cc-89d7-493ef4eb842e"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[281]=",
 CellID->2009136553,ExpressionUUID->"a62609c7-f1bb-4506-b247-eaa02ac65aa3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Method 2: Using Permutation", "Subsection",
 CellID->1197910904,ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571"],

Cell["\<\
Here, we find the permutation corresponding to the required basis change and \
use it to construct the unitary matrix.\
\>", "TechNoteText",
 CellID->368440934,ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conststructUnitary", "::", "usage"}], 
   "=", "\"\<contructUnitary[m, n] finds the permutation of computational \
basis states of n qubits, where states with total spin m are mapped to the \
standard computational basis states of the first k qubits with other qubits \
set to zero. Here, k=Log[2,Binomial[n,m]]. It returns the matrix representing \
the permutation.\>\""}], ";"}]], "Input",
 CellLabel->"In[288]:=",
 CellID->51525796,ExpressionUUID->"4b958e15-d987-41e0-abc5-b9185f63b5e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"constructUnitary", "::", "bad"}], 
   "=", "\"\<States with `` non-zero qubits in a register of `` qubits cannot \
be encoded in a finite number of qubits.\>\""}], ";"}]], "Input",
 CellLabel->"In[289]:=",
 CellID->519669879,ExpressionUUID->"b1a0849a-e0e4-4110-9379-03572ca61286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"constructUnitary", "[", 
   RowBox[{"m_Integer", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"org", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bin", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "m"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "src", ",", "dst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"IntegerQ", "@", "bin"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"constructUnitary", "::", "bad"}], ",", "m", ",", "n"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"One", "@", 
          RowBox[{"Power", "[", 
           RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"Permutations", "@", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", "m"}], "]"}], ",", "n"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"src", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "bin"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dst", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"dst", ",", "org"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{"src", ",", "org"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tau", "=", 
      RowBox[{"FindPermutation", "@", 
       RowBox[{"Permute", "[", 
        RowBox[{"dst", ",", "tau"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PermutationMatrix", "[", 
      RowBox[{"tau", ",", 
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "n"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[290]:=",
 CellID->1699974289,ExpressionUUID->"764b5ce3-5ce9-42f1-b3be-131a954406db"],

Cell[TextData[{
 "Take an example for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "2dade0aa-4c4c-49ad-b70e-930828d95a12"],
 ". Each row or column contains exactly one element of value 1 and all other \
elements are zero, indicating the matrix represents a permutation."
}], "TechNoteMathCaption",
 CellID->415624317,ExpressionUUID->"d42139df-0aa3-4a77-b6fe-81442593f640"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"constructUnitary", "[", 
    RowBox[{"3", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[291]:=",
 CellID->584821147,ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
    PermutationMatrix[
     StructuredArray`StructuredData[{16, 16}, {
       Cycles[{{1, 8, 6, 4, 3, 2}, {5, 12, 10, 7}, {9, 14, 11}, {13, 15}}], 
       DirectedInfinity[1]}]]]]]], "Output",
 CellLabel->"Out[292]//MatrixForm=",
 CellID->1412056904,ExpressionUUID->"68b5474a-ebc5-4218-9414-80c787c293d7"]
}, Open  ]],

Cell["Construct the operators corresponding to the above matrix.", \
"TechNoteMathCaption",
 CellID->914831718,ExpressionUUID->"8c5e052e-4a8e-44fb-b73a-ce8d6c784e30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trsA", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "AA"}], "]"}], "//", "Elaborate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trsB", "=", 
   RowBox[{
    RowBox[{"ExpressionFor", "[", 
     RowBox[{"mat", ",", "BB"}], "]"}], "//", "Elaborate"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[293]:=",
 CellID->21183722,ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796"],

Cell["\<\
Examine if the operator properly maps the computational basis states for \
Alice's qubits.\
\>", "TechNoteMathCaption",
 CellID->643016337,ExpressionUUID->"8ec11b73-d238-48f9-a270-0f97be90f10e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "AA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"trsA", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[298]:=",
 CellID->2108504836,ExpressionUUID->"04ef3573-49c8-4b84-ae4a-2dd687116721"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`A[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
          1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
          1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[300]//TableForm=",
 CellID->658915986,ExpressionUUID->"9adcd59f-d8de-42cc-84f5-b404b15a1261"]
}, Open  ]],

Cell["\<\
Also examine if the operator properly maps the computational basis states for \
Bob's qubits.\
\>", "TechNoteMathCaption",
 CellID->608333358,ExpressionUUID->"f5202df5-afe9-47fa-b064-9a4436567940"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "BB", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"trsB", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[301]:=",
 CellID->2051353892,ExpressionUUID->"86fd9729-c9a9-4e2b-9a24-819d51c6fe42"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>]],
        "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"3"}, "RowDefault"]], 
              $CellContext`B[3, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"4"}, "RowDefault"]], 
              $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
          1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[303]//TableForm=",
 CellID->636306360,ExpressionUUID->"d266b656-899f-4840-a965-29b3cf11a887"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall", "TechNoteSection",
 CellID->1248933531,ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35"],

Cell["\<\
Now, we have all components. Our desired quantum circuit is as follows. The \
first part generates four partially entangled pairs, the second measures the \
total Pauli Z on Bob's register, and the last transforms the post-measurement \
state a fixed pair of qubits from Alice's and Bob's registers.\
\>", "TechNoteText",
 CellID->1308352194,ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"all", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"qc2", ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", "trsA", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", "trsB", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ","}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[282]:=",
 CellID->1320689739,ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{16, -11}, {20, -11}}, {{16, -12}, {20, -12}}, {{16, -13}, {
      20, -13}}}]}, 
    LineBox[{{{0, -1}, {20, -1}}, {{0, -2}, {20, -2}}, {{0, -3}, {20, -3}}, {{
     0, -4}, {20, -4}}, {{0, -6}, {20, -6}}, {{0, -7}, {20, -7}}, {{0, -8}, {
     20, -8}}, {{0, -9}, {20, -9}}, {{0, -11}, {16, -11}}, {{0, -12}, {
     16, -12}}, {{0, -13}, {16, -13}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -11}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -12}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -13}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -7}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -8}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.016000000000000004`],
        FontWeight->"Light"], {-0.1, -9}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"y\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.020000000000000004`],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {LineBox[{{2, -1}, {2, -6}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -7}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -8}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -8}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -8}, {4.266666666666667, -8}}, {{
         4, -8.266666666666667}, {4, -7.733333333333333}}}]}}, {
     LineBox[{{5, -4}, {5, -9}}], 
     DiskBox[{5, -4}, 0.09], {CircleBox[{5, -9}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -9}, {5.266666666666667, -9}}, {{
         5, -9.266666666666667}, {5, -8.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{6, Rational[-29, 2]}, {6, Rational[-1, 2]}}, {{
        6, -14.5}, {6, -0.5}}]]}, {LineBox[{{7, -6}, {7, -11}}], 
     DiskBox[{7, -6}, 0.09], {CircleBox[{7, -11}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -11}, {7.266666666666667, -11}}, {{
         7, -11.266666666666667`}, {7, -10.733333333333333`}}}]}}, {
     LineBox[{{8, -7}, {8, -11}, {8, -12}}], DiskBox[{8, -7}, 0.09], 
     DiskBox[{8, -11}, 0.09], {CircleBox[{8, -12}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -12}, {8.266666666666667, -12}}, {{
         8, -12.266666666666667`}, {8, -11.733333333333333`}}}]}}, {
     LineBox[{{9, -7}, {9, -11}}], 
     DiskBox[{9, -7}, 0.09], {CircleBox[{9, -11}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -11}, {9.266666666666667, -11}}, {{
         9, -11.266666666666667`}, {9, -10.733333333333333`}}}]}}, {
     LineBox[{{10, -8}, {10, -11}, {10, -12}}], DiskBox[{10, -8}, 0.09], 
     DiskBox[{10, -11}, 0.09], {CircleBox[{10, -12}, 0.26666666666666666], 
      LineBox[{{{9.733333333333333, -12}, {10.266666666666667`, -12}}, {{
         10, -12.266666666666667`}, {10, -11.733333333333333`}}}]}}, {
     LineBox[{{11, -8}, {11, -11}}], 
     DiskBox[{11, -8}, 0.09], {CircleBox[{11, -11}, 0.26666666666666666], 
      LineBox[{{{10.733333333333333`, -11}, {11.266666666666667`, -11}}, {{
         11, -11.266666666666667`}, {11, -10.733333333333333`}}}]}}, {
     LineBox[{{12, -9}, {12, -11}, {12, -12}, {12, -13}}], 
     DiskBox[{12, -9}, 0.09], DiskBox[{12, -11}, 0.09], 
     DiskBox[{12, -12}, 0.09], {CircleBox[{12, -13}, 0.26666666666666666], 
      LineBox[{{{11.733333333333333`, -13}, {12.266666666666667`, -13}}, {{
         12, -13.266666666666667`}, {12, -12.733333333333333`}}}]}}, {
     LineBox[{{13, -9}, {13, -11}, {13, -12}}], DiskBox[{13, -9}, 0.09], 
     DiskBox[{13, -11}, 0.09], {CircleBox[{13, -12}, 0.26666666666666666], 
      LineBox[{{{12.733333333333333`, -12}, {13.266666666666667`, -12}}, {{
         13, -12.266666666666667`}, {13, -11.733333333333333`}}}]}}, {
     LineBox[{{14, -9}, {14, -11}}], 
     DiskBox[{14, -9}, 0.09], {CircleBox[{14, -11}, 0.26666666666666666], 
      LineBox[{{{13.733333333333333`, -11}, {14.266666666666667`, -11}}, {{
         14, -11.266666666666667`}, {14, -10.733333333333333`}}}]}}, {{{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -11.4}, {16.4, -10.6}]}, 
       LineBox[{{15.6, -11.4}, {16.4, -11.4}, {16.4, -10.6}, {15.6, -10.6}, {
        15.6, -11.4}}]}, 
      CircleBox[{16, -11.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -11.2}, {16.24, -10.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -12.4}, {16.4, -11.6}]}, 
       LineBox[{{15.6, -12.4}, {16.4, -12.4}, {16.4, -11.6}, {15.6, -11.6}, {
        15.6, -12.4}}]}, 
      CircleBox[{16, -12.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -12.2}, {16.24, -11.76}}]}, {{
       {GrayLevel[1], EdgeForm[None], 
        RectangleBox[{15.6, -13.4}, {16.4, -12.6}]}, 
       LineBox[{{15.6, -13.4}, {16.4, -13.4}, {16.4, -12.6}, {15.6, -12.6}, {
        15.6, -13.4}}]}, 
      CircleBox[{16, -13.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{16, -13.2}, {16.24, -12.76}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{17, Rational[-29, 2]}, {17, Rational[-1, 2]}}, {{
        17, -14.5}, {17, -0.5}}]]}, {
     LineBox[{{18, -11}, {18, -12}, {18, -13}, {18, -1}, {18, -2}, {18, -3}, {
      18, -4}}], DiskBox[{18, -11}, 0.09], DiskBox[{18, -12}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{18, -13}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{17.6, -4.4}, {18.4, -0.6}]},
      LineBox[{{17.6, -4.4}, {18.4, -4.4}, {18.4, -0.6}, {17.6, -0.6}, {
      17.6, -4.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{18, Rational[-5, 2]}, {18, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{19, -11}, {19, -12}, {19, -13}, {19, -6}, {19, -7}, {19, -8}, {
      19, -9}}], DiskBox[{19, -11}, 0.09], DiskBox[{19, -12}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{19, -13}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{18.6, -9.4}, {19.4, -5.6}]},
      LineBox[{{18.6, -9.4}, {19.4, -9.4}, {19.4, -5.6}, {18.6, -5.6}, {
      18.6, -9.4}}], InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.020000000000000004`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{19, Rational[-15, 2]}, {19, -7.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->766.8000000000001,
   PlotRange->NCache[{Full, {
       Rational[-29, 2], 
       Rational[-1, 2]}}, {Full, {-14.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3S`QuantumCircuit[
   Q3S`QuantumCircuitIn[
    Ket[<|$CellContext`T[1, Q3S`$] -> 0, $CellContext`T[2, Q3S`$] -> 
      0, $CellContext`T[3, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]], {
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[1, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[2, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[3, 2]], 
    Q3S`Rotation[Rational[2, 3] Pi, 
     $CellContext`A[4, 2]]}, 
   Q3S`CNOT[{
      $CellContext`A[1, Q3S`$]} -> {1}, {
     $CellContext`B[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[2, Q3S`$]} -> {1}, {
     $CellContext`B[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[3, Q3S`$]} -> {1}, {
     $CellContext`B[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`A[4, Q3S`$]} -> {1}, {
     $CellContext`B[4, Q3S`$]}], "Separator", 
   Q3S`CNOT[{
      $CellContext`B[1, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[2, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[3, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$], 
      $CellContext`T[2, Q3S`$]} -> {1, 1, 1}, {
     $CellContext`T[3, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$], 
      $CellContext`T[1, Q3S`$]} -> {1, 1}, {
     $CellContext`T[2, Q3S`$]}], 
   Q3S`CNOT[{
      $CellContext`B[4, Q3S`$]} -> {1}, {
     $CellContext`T[1, Q3S`$]}], "Spacer", 
   Q3S`Measurement[{
     $CellContext`T[1, 3], 
     $CellContext`T[2, 3], 
     $CellContext`T[3, 3]}], "Separator", 
   Q3S`ControlledGate[{
      $CellContext`T[1, Q3S`$], 
      $CellContext`T[2, Q3S`$], 
      $CellContext`T[3, Q3S`$]} -> {1, 1, 0}, 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       0, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       0|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 
       1|>, <|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
       1, $CellContext`A[3, Q3S`$] -> 1, $CellContext`A[4, Q3S`$] -> 1|>], 
    "Label" -> "U"], 
   Q3S`ControlledGate[{
      $CellContext`T[1, Q3S`$], 
      $CellContext`T[2, Q3S`$], 
      $CellContext`T[3, Q3S`$]} -> {1, 1, 0}, 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 1|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       0, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       0|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>] + 
    Q3S`Dyad[<|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 
       1|>, <|$CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
       1, $CellContext`B[3, Q3S`$] -> 1, $CellContext`B[4, Q3S`$] -> 1|>], 
    "Label" -> "U"], Null, "Invisible" -> {
     $CellContext`A[
      Rational[9, 2]], 
     $CellContext`B[
      Rational[9, 2]], 
     $CellContext`T[5]}, "Invisible" -> $CellContext`A[
     Rational[9, 2]], "Invisible" -> $CellContext`B[
     Rational[9, 2]]]]], "Output",
 CellLabel->"Out[282]=",
 CellID->1987750180,ExpressionUUID->"66105c2c-c0eb-46cf-b5bb-7bdff93bf20f"]
}, Open  ]],

Cell[TextData[{
 "Because the transformation on Alice\[CloseCurlyQuote]s and Bob\
\[CloseCurlyQuote]s sides are designed for the measurement outcome of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "tot"], "=", "3"}], TraditionalForm]],ExpressionUUID->
  "dc39250d-3b55-4171-884d-083a187d5835"],
 ", we just run the quantum circuit until we get the desired outcome."
}], "TechNoteText",
 CellID->196356282,ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Until", "[", 
   RowBox[{
    RowBox[{"ztot", "==", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EchoTiming", "[", 
      RowBox[{"out", "=", 
       RowBox[{"Elaborate", "[", "all", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ztot", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Reverse", "@", 
         RowBox[{"Readout", "[", 
          RowBox[{"Through", "[", 
           RowBox[{"TT", "[", "3", "]"}], "]"}], "]"}]}], ",", "2"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(Z\), \(tot\)]\)=\>\"", ",", "ztot"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellLabel->"In[284]:=",
 CellID->1625149782,ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d"],

Cell[BoxData["0.528074`"], "EchoTiming",
 CellID->1889298093,ExpressionUUID->"7a122a9d-ab19-4c01-94ed-d4afc7dece29"]
}, Open  ]],

Cell[TextData[{
 "Here is the output state of the total system. Obviously, the whole register \
",
 StyleBox["T",
  FontSlant->"Italic"],
 " is separated from the other two registers. So are the last two registers \
of the respective registers A and B."
}], "TechNoteText",
 CellID->47879881,ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2"],

Cell[CellGroupData[{

Cell[BoxData["out"], "Input",
 CellLabel->"In[285]:=",
 CellID->1558275989,ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`A[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`A[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`A[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"A"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`A[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`B[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`B[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`B[3, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"B"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], 
          $CellContext`B[4, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], 
          $CellContext`T[1, Q3S`$]]], 
        SubscriptBox["1", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], 
          $CellContext`T[2, Q3S`$]]], 
        SubscriptBox["0", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"T"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], 
          $CellContext`T[3, Q3S`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]]}]}]], "Output",
 CellLabel->"Out[285]=",
 CellID->1053379672,ExpressionUUID->"2b879a62-9746-4344-844b-ee4f650a4ee6"]
}, Open  ]],

Cell["\<\
Focusing on the first two qubits of registers A and B, we see that there are \
two maximally entangled pairs.\
\>", "TechNoteText",
 CellID->1953490389,ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"B", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[286]:=",
 CellID->1582972587,ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"0", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"0", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "0"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "0"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      0, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      0, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        TemplateBox[{"1", "1"}, "RowDefault"], "\";\"", 
        TemplateBox[{"1", "1"}, "RowDefault"]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`A[2, Q3S`$] -> 
      1, $CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 
      0, $CellContext`B[1, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
      1, $CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0, $CellContext`T[1, Q3S`$] -> 1, $CellContext`T[2, Q3S`$] -> 
      1, $CellContext`T[3, Q3S`$] -> 0|>]], "2"]}]], "Output",
 CellLabel->"Out[286]=",
 CellID->367111081,ExpressionUUID->"10451ea2-9189-4334-9aa1-dd97f0738fac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "@", 
  RowBox[{"KetDrop", "[", 
   RowBox[{"out", ",", "TT"}], "]"}]}]], "Input",
 CellLabel->"In[287]:=",
 CellID->1686302499,ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  InterpretationBox[
   TagBox[
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`A[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"A"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`A[4, Q3S`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>]], 
     "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`B[1, Q3S`$] -> 
          0|>]], "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`A[1, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"1"}, "RowDefault"]], 
              $CellContext`B[1, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`B[1, Q3S`$] -> 
          1|>]]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["0", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[2, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 
          0|>]], "+", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"A"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`A[2, Q3S`$]]], 
            SubscriptBox["1", 
             InterpretationBox[
              SubscriptBox[
               TemplateBox[{"B"}, "RowDefault"], 
               TemplateBox[{"2"}, "RowDefault"]], 
              $CellContext`B[2, Q3S`$]]]}, "RowDefault"]},
         "Ket"],
        Ket[<|$CellContext`A[2, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 
          1|>]]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`B[3, Q3S`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"B"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`B[4, Q3S`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 0|>]]}],
    HoldForm],
   Q3S`OTimes[
    Ket[<|$CellContext`A[3, Q3S`$] -> 0, $CellContext`A[4, Q3S`$] -> 0|>], 
    Ket[<|$CellContext`A[1, Q3S`$] -> 0, $CellContext`B[1, Q3S`$] -> 0|>] + 
    Ket[<|$CellContext`A[1, Q3S`$] -> 1, $CellContext`B[1, Q3S`$] -> 1|>], 
    Ket[<|$CellContext`A[2, Q3S`$] -> 0, $CellContext`B[2, Q3S`$] -> 0|>] + 
    Ket[<|$CellContext`A[2, Q3S`$] -> 1, $CellContext`B[2, Q3S`$] -> 1|>], 
    Ket[<|$CellContext`B[3, Q3S`$] -> 0, $CellContext`B[4, Q3S`$] -> 
      0|>]]]}]], "Output",
 CellLabel->"Out[287]=",
 CellID->1859921424,ExpressionUUID->"11124e8d-470f-40f0-bb2a-95fdd936f4a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Remark", "Subsection",
 CellID->1711953502,ExpressionUUID->"5c2b93ae-be33-40b7-b8ef-ff87a493a2fe"],

Cell[TextData[{
 "So, we have successfully generated two maximally entangled pairs from four \
partially entangled pairs. Note that this was possible because we assumed \
that the measurement outcome was ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "3"}], TraditionalForm]],ExpressionUUID->
  "bd5cbb57-6676-47c8-a756-8a7d67ac9bd9"],
 ". The case with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "e34fe256-4a81-46b0-a12a-6b30f191ae4e"],
 " is also handled following a similar procedure."
}], "TechNoteText",
 CellID->862841207,ExpressionUUID->"c7e7b19a-c245-42b9-afc6-94e338438ede"],

Cell[TextData[{
 "However, if the measurement outcome is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "=", "2"}], TraditionalForm]],ExpressionUUID->
  "20a9fc09-2474-42eb-8210-d951aed89d91"],
 ", resulting in the post-measurement state"
}], "TechNoteText",
 CellID->719303896,ExpressionUUID->"b4416a65-1b9d-4504-8192-c4e67a1852e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "0", "1", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "1", "0", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"0", "1", "1", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "0", "0", "1"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "0", "1", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   TemplateBox[{
     TemplateBox[{
       TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"], 
     "\"\[CircleTimes]\"", 
     TemplateBox[{
       TemplateBox[{"1", "1", "0", "0"}, "RowDefault"]}, "Ket"]},
    "RowDefault"]}]}]], "Output",
 CellID->2025483658,ExpressionUUID->"7f50fa65-79c4-4207-a529-353b4b07cfaa"],

Cell["\<\
then there is no way to turn this state into a product state on a system of \
qubits.\
\>", "TechNoteText",
 CellID->994499068,ExpressionUUID->"ff58addb-5baa-44ef-bf49-bac6abdf8a72"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "12953a1e-cd45-4feb-a834-84510cc5a5da"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Many-Body Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/guide/QuantumManyBodySystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "69499c83-e992-4ce4-aa1f-ec742262268b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Spin Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/guide/QuantumSpinSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "26794b5e-2316-4a4d-9394-6d966bdc1ad8"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"ea02fdc9-7338-4a8e-917c-\
8960a1307170"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "A Quantum Playbook",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/QuantumPlaybook/tutorial/QuantumPlaybook"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "edc9fe84-7d53-4f6b-b973-35f6f6169405"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Entanglement Distillation",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/QuantumPlaybook/tutorial/\
EntanglementDistillation"]], "RelatedTutorials",ExpressionUUID->
         "de55eb4d-0b28-4dc4-8ba9-1c4f1884eeb8"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Theory",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationTheory"]], 
         "RelatedTutorials",ExpressionUUID->
         "61b46736-1ad7-4837-b3c8-62bf16de2d9c"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "9efb07f7-0154-4339-ad00-5e07c0e254fc"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Many-Body Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumManyBodySystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "f3d9fc6a-1ff4-4f1e-9add-4d8fdff592b7"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Spin Systems with Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumSpinSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "a844265d-8753-4a48-b6d2-70c2897cc3d8"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"4cdfaaed-da68-4c5f-914d-\
d67caccfaacb"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Preskill (1998)"}]]]], 
             "http://theory.caltech.edu/~preskill/ph229/"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "175d0639-7b07-4ae2-84ae-c302f6b553e6"]}]],ExpressionUUID->
         "16335051-242a-44a4-98e9-8abc9b3081cb"],
        ", Lecture Notes for Physics 229: Quantum Information and Computation."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "bfef24ae-266b-4952-adb1-3f880d882881"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c9d46927-0ad4-4521-b747-d40396eeba60"]}]],ExpressionUUID->
         "82cd125a-009d-41bd-b0ff-ae29942a713f"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press, 2011).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "57202c2e-1a2d-491f-b66d-1bc8e6794516"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "527bcbb5-4cc6-465e-8037-d0cbd02aa09d"]}]],ExpressionUUID->
         "3160342a-9f65-42ce-897c-420ee164263b"],
        ", A Quantum Computation Workbook (Springer, 2022)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "4740f4eb-d4a7-4547-a903-2b78e4a1ed8f"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"2d9224c4-15a9-4a70-9fe7-\
5bf9c79f3405"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"b26e405a-1997-43bb-a19d-6129a0958dd8"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Entanglement Distillation",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2022", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 4, 1, 37, 18.401027}", 
    "history" -> {"13.1", "", "", ""}, "context" -> 
    "QuantumMob`QuantumPlaybook`", 
    "keywords" -> {
     "quantum entanglement", "entanglement distillation", 
      "entanglement purification"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Quantum Playbook Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/QuantumPlaybook", "status" -> "None", "summary" -> 
    "See also Section 7.3 of the Quantum Workbook (Springer, 2022). Here, we \
start with a number of partially entangled pairs and 'distills' a smaller \
number of maximally entangled pairs. This is illustrated in the quantum \
circuit model. Let us first examine a single pair of partially entangled \
qubits.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Entanglement Distillation", "titlemodifier" -> "", "metadescription" -> 
    "", "windowtitle" -> "Entanglement Distillation", "type" -> "Tech Note", 
    "uri" -> "QuantumMob/QuantumPlaybook/tutorial/EntanglementDistillation"}},\

FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"8d7594be-9850-451d-83da-7b2fe1a50998"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 7777, 186, 50, "AnchorBarGrid",ExpressionUUID->"b7671edd-a9b6-4159-82d5-38f57b45a2f6",
 CellID->1],
Cell[CellGroupData[{
Cell[8395, 211, 126, 1, 67, "TechNoteTitle",ExpressionUUID->"e3335ae1-3816-4b0a-ac1a-259ca89dd70f",
 CellID->1980526771],
Cell[8524, 214, 3995, 92, 86, "TechNoteJumpBox",ExpressionUUID->"2ffede48-6c75-4655-8d62-02aa0fc958a2"],
Cell[12522, 308, 418, 13, 34, "TechNoteText",ExpressionUUID->"60fe75fc-9244-469e-9e07-e8b1d661bdfd",
 CellID->1308734266],
Cell[12943, 323, 418, 11, 57, "TechNoteText",ExpressionUUID->"1c91212a-cb27-4a49-a2e0-caaf7a40a765",
 CellID->444601366],
Cell[13364, 336, 1174, 30, 118, "DefinitionBox",ExpressionUUID->"36dce4c0-3b60-4b8b-bb7a-648a7d616204",
 CellID->1410604422],
Cell[14541, 368, 135, 1, 30, "TechNoteCaption",ExpressionUUID->"03c06594-0719-45e4-bd4f-139b405618da",
 CellID->1956541321],
Cell[14679, 371, 135, 1, 35, "TechNoteMathCaption",ExpressionUUID->"e626cdff-edee-405c-9619-fd3186ec257b",
 CellID->1329022598],
Cell[14817, 374, 180, 3, 28, "Input",ExpressionUUID->"5c3cdfba-d3e5-4be2-8be5-e654424db65f",
 CellID->172539488],
Cell[15000, 379, 242, 4, 35, "TechNoteMathCaption",ExpressionUUID->"f8b90b09-75fd-41d3-b787-db4ae55bcfa2",
 CellID->1573161274],
Cell[15245, 385, 203, 4, 28, "Input",ExpressionUUID->"26dfcfe6-26c0-4548-a0c2-ae2be1681d41",
 CellID->768251366],
Cell[15451, 391, 212, 6, 35, "TechNoteMathCaption",ExpressionUUID->"0f4181d3-092f-4fd3-ace1-f7e04b7ffa73",
 CellID->1676761233],
Cell[15666, 399, 521, 15, 81, "Input",ExpressionUUID->"f194e1a4-d4f1-4185-adf5-f329e1d25e04",
 CellID->363452503],
Cell[16190, 416, 241, 6, 35, "TechNoteMathCaption",ExpressionUUID->"269f75b3-05f0-4f3b-8f4a-0877703dd84e",
 CellID->1432690958],
Cell[16434, 424, 441, 13, 45, "Input",ExpressionUUID->"d399fc7a-8f68-41b8-890c-1914542401c6",
 CellID->1164469075],
Cell[CellGroupData[{
Cell[16900, 441, 137, 1, 79, "TechNoteSection",ExpressionUUID->"67eace02-e406-44a8-ac18-deb8074e746b",
 CellID->9608243],
Cell[CellGroupData[{
Cell[17062, 446, 110, 1, 58, "Subsection",ExpressionUUID->"58b778a6-05e8-4fc3-9347-97575fdfbaec",
 CellID->895983480],
Cell[17175, 449, 172, 3, 70, "TechNoteText",ExpressionUUID->"ee0d4f6b-5310-42de-a349-486686a0f204",
 CellID->963914888],
Cell[17350, 454, 215, 4, 70, "TechNoteMathCaption",ExpressionUUID->"4455ccba-7011-4cdd-a3c0-3de7d5557c44",
 CellID->1326468628],
Cell[CellGroupData[{
Cell[17590, 462, 564, 14, 70, "Input",ExpressionUUID->"ff095bbe-fdef-474c-b90c-de4fe7dbf16a",
 CellID->424466576],
Cell[18157, 478, 1387, 37, 57, "Output",ExpressionUUID->"ab45b13c-29c2-4612-80e1-367c4c938c97",
 CellID->345470920]
}, Open  ]],
Cell[19559, 518, 641, 19, 70, "TechNoteMathCaption",ExpressionUUID->"b775cd35-77ca-43a9-8064-bb4eb73e9f22",
 CellID->1200711519],
Cell[CellGroupData[{
Cell[20225, 541, 196, 4, 70, "Input",ExpressionUUID->"c7be65ad-a30d-4db6-bee1-1f860f9a9dd9",
 CellID->1176269506],
Cell[20424, 547, 996, 31, 48, "Output",ExpressionUUID->"24176084-ba69-4561-a2cd-c0d425da5f60",
 CellID->594998522]
}, Open  ]],
Cell[21435, 581, 190, 3, 70, "TechNoteMathCaption",ExpressionUUID->"3edfed6c-bf50-4ecd-9084-d10869c27e54",
 CellID->1153639981],
Cell[CellGroupData[{
Cell[21650, 588, 702, 19, 70, "Input",ExpressionUUID->"06706e9a-b84e-4e6f-87c1-7011523ced6e",
 CellID->1509698055],
Cell[22355, 609, 2070, 50, 92, "Output",ExpressionUUID->"62daf495-5ea3-42ae-8970-28a75ffa29d0",
 CellID->1015107827]
}, Open  ]],
Cell[24440, 662, 439, 10, 70, "TechNoteMathCaption",ExpressionUUID->"70773f4c-3264-40dc-8059-b8b90e1b9b1a",
 CellID->424047388],
Cell[CellGroupData[{
Cell[24904, 676, 189, 4, 70, "Input",ExpressionUUID->"dc12f677-158d-4246-9557-c7893481ec36",
 CellID->2084847387],
Cell[25096, 682, 1484, 44, 48, "Output",ExpressionUUID->"4cd3cc77-5a72-4ec0-8e78-424f383ae11b",
 CellID->1139705760]
}, Open  ]],
Cell[26595, 729, 223, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f3934c61-3e97-4ba8-bf03-dfb369a8a3df",
 CellID->1376812949],
Cell[CellGroupData[{
Cell[26843, 737, 519, 15, 70, "Input",ExpressionUUID->"a26928a2-7adf-4dfc-b6af-d1b73235e24d",
 CellID->1003824959],
Cell[27365, 754, 956, 28, 79, "Output",ExpressionUUID->"45db5982-d3b8-4857-9fd1-6d491452e91e",
 CellID->1475663078]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28370, 788, 111, 1, 70, "Subsection",ExpressionUUID->"5b28959a-a2ff-4e73-bec9-da1693954f99",
 CellID->443447814],
Cell[28484, 791, 795, 22, 70, "TechNoteText",ExpressionUUID->"f3d9c9d2-149a-43bc-b609-cd9dd58fef1c",
 CellID->2081747837],
Cell[29282, 815, 271, 5, 70, "TechNoteMathCaption",ExpressionUUID->"20301db3-9431-4eb6-80db-fdfe37b269e5",
 CellID->70875601],
Cell[CellGroupData[{
Cell[29578, 824, 894, 22, 70, "Input",ExpressionUUID->"49597941-f7d9-4a17-a29d-113d9875318c",
 CellID->170713811],
Cell[30475, 848, 6728, 158, 341, "Output",ExpressionUUID->"7f29f2a1-9388-44bd-aeae-3be85ade472a",
 CellID->238783619]
}, Open  ]],
Cell[37218, 1009, 241, 4, 70, "TechNoteMathCaption",ExpressionUUID->"115db23e-3de8-43d4-93b5-3d0b58b21815",
 CellID->1017693123],
Cell[CellGroupData[{
Cell[37484, 1017, 352, 9, 70, "Input",ExpressionUUID->"3d9c0a09-4f34-426d-a193-2139db7333ae",
 CellID->1372770070],
Cell[37839, 1028, 11368, 275, 168, "Output",ExpressionUUID->"a5aba9a9-7f73-4682-8c85-87c71867cdd6",
 CellID->743762127]
}, Open  ]],
Cell[49222, 1306, 865, 22, 70, "TechNoteText",ExpressionUUID->"aadce766-e449-4160-83e8-dfd4254d70d8",
 CellID->1171545641],
Cell[50090, 1330, 672, 21, 70, "Input",ExpressionUUID->"70e2f9d9-c8a9-4ec3-b730-fc7f9b5be262",
 CellID->225912086],
Cell[50765, 1353, 945, 29, 70, "TechNoteText",ExpressionUUID->"2c4b1d54-f870-458a-afbf-8eaad838da15",
 CellID->428998052],
Cell[CellGroupData[{
Cell[51735, 1386, 801, 20, 70, "Input",ExpressionUUID->"f9b6efeb-5191-4ff5-afc2-4239e623f4ea",
 CellID->153341506],
Cell[52539, 1408, 6173, 174, 70, "Output",ExpressionUUID->"8417e826-0a52-47ce-81d8-e719e32a5fb5",
 CellID->667441612]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58773, 1589, 130, 1, 70, "TechNoteSection",ExpressionUUID->"2a853ae2-2058-412a-894e-7d95da384bfb",
 CellID->224262840],
Cell[58906, 1592, 637, 15, 70, "TechNoteText",ExpressionUUID->"48fc5445-ae2b-4f18-b082-3fca0c66c976",
 CellID->1184887274],
Cell[59546, 1609, 368, 10, 70, "TechNoteMathCaption",ExpressionUUID->"2190b60b-1c08-44ad-91b6-6d3198502349",
 CellID->1611641769],
Cell[CellGroupData[{
Cell[59939, 1623, 197, 5, 70, "Input",ExpressionUUID->"e30d9019-04c2-4dd3-a672-bc7be9efeebf",
 CellID->984885170],
Cell[60139, 1630, 176, 4, 49, "Output",ExpressionUUID->"4d6525d8-225b-41c6-9015-4265721cc354",
 CellID->1748576565]
}, Open  ]],
Cell[60330, 1637, 154, 1, 70, "TechNoteMathCaption",ExpressionUUID->"080e79ed-ca53-459c-b818-d710af35f15c",
 CellID->145578351],
Cell[60487, 1640, 1294, 36, 70, "Input",ExpressionUUID->"6cc38884-16f5-4c2e-bb3e-51700d3b779e",
 CellID->1429019289],
Cell[61784, 1678, 455, 10, 70, "TechNoteMathCaption",ExpressionUUID->"83e8397c-67e1-4283-8dfe-900d952b47a9",
 CellID->2075092591],
Cell[CellGroupData[{
Cell[62264, 1692, 522, 12, 70, "Input",ExpressionUUID->"d5f55e09-e0dd-4c39-ba05-d16295e1b36a",
 CellID->2010699221],
Cell[62789, 1706, 4663, 104, 307, "Output",ExpressionUUID->"a48c7ead-8786-4440-a374-a6f9db9bc017",
 CellID->1313508407]
}, Open  ]],
Cell[67467, 1813, 229, 4, 70, "TechNoteText",ExpressionUUID->"2fdeadd1-433c-4ef3-b77b-9dfeab324f57",
 CellID->325402613],
Cell[67699, 1819, 303, 8, 70, "Input",ExpressionUUID->"0c482a0e-e3b6-4886-a0bd-728c06f40347",
 CellID->1548351429],
Cell[CellGroupData[{
Cell[68027, 1831, 550, 16, 70, "Input",ExpressionUUID->"53394859-0040-40fb-8179-e73fc1c198d7",
 CellID->2083116504],
Cell[68580, 1849, 6445, 176, 369, "Output",ExpressionUUID->"713b775d-c91d-47eb-9d72-9d6f7709437c",
 CellID->95040948]
}, Open  ]],
Cell[75040, 2028, 471, 11, 70, "TechNoteMathCaption",ExpressionUUID->"a9e378e2-6d5a-415c-9f6f-20ddb36eb0f3",
 CellID->1803890242],
Cell[CellGroupData[{
Cell[75536, 2043, 799, 21, 70, "Input",ExpressionUUID->"79ed82a4-2741-41e7-9d18-bd88e99cf41d",
 CellID->817515057],
Cell[76338, 2066, 12572, 279, 524, "Output",ExpressionUUID->"283086ee-b07b-45ea-8fad-b518201ec1a8",
 CellID->876300292]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88959, 2351, 116, 1, 70, "TechNoteSection",ExpressionUUID->"0f894b3d-c2fd-4322-867c-318ebbf73e83",
 CellID->797821259],
Cell[89078, 2354, 1631, 41, 70, "TechNoteText",ExpressionUUID->"43916a76-a876-4e48-ad11-1940ad29c6b3",
 CellID->695573627],
Cell[90712, 2397, 224, 4, 70, "TechNoteText",ExpressionUUID->"33f1b9a2-d4ed-4ee1-8b0b-0b65a7865bde",
 CellID->1699338655],
Cell[90939, 2403, 682, 24, 70, "TechNoteText",ExpressionUUID->"be691043-e547-4f15-8e06-076fc92110c8",
 CellID->1399753132],
Cell[91624, 2429, 1336, 43, 70, "TechNoteText",ExpressionUUID->"2921f348-905f-443f-acb8-2bd0d40c2538",
 CellID->2115020286],
Cell[92963, 2474, 684, 14, 70, "TechNoteText",ExpressionUUID->"13dcc265-2807-410d-b51c-0886469ac26a",
 CellID->1996621658],
Cell[93650, 2490, 1076, 42, 70, "TechNoteText",ExpressionUUID->"f6e66ca7-5ad0-448d-9b05-837f2f8b0565",
 CellID->640737984],
Cell[94729, 2534, 515, 12, 70, "TechNoteText",ExpressionUUID->"39fb159e-2f1c-4b9d-b3d7-4545e63fee32",
 CellID->1266994926],
Cell[CellGroupData[{
Cell[95269, 2550, 118, 1, 70, "Subsection",ExpressionUUID->"3e29fedb-a31e-47cd-9806-5e721284d533",
 CellID->1145574102],
Cell[95390, 2553, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"b628ac1d-6b05-4590-bf55-0ea77b2b73eb",
 CellID->920704413],
Cell[CellGroupData[{
Cell[95611, 2561, 271, 6, 70, "Input",ExpressionUUID->"68fbf39b-d569-4d6e-bf37-5129d1f01af0",
 CellID->989436024],
Cell[95885, 2569, 17501, 485, 76, "Output",ExpressionUUID->"eac09c35-cf1f-4c5a-a14c-6c6b798c8094",
 CellID->1303143257],
Cell[113389, 3056, 17501, 485, 76, "Output",ExpressionUUID->"c2030a24-e116-4dbb-a1ff-2c670100b178",
 CellID->1890488293]
}, Open  ]],
Cell[130905, 3544, 451, 11, 70, "TechNoteMathCaption",ExpressionUUID->"f3616645-327d-4284-9237-a987b918be6a",
 CellID->284257392],
Cell[CellGroupData[{
Cell[131381, 3559, 1117, 33, 70, "Input",ExpressionUUID->"c84f116c-1d33-4084-8a4f-47e4eba37184",
 CellID->576306453],
Cell[132501, 3594, 17501, 485, 76, "Output",ExpressionUUID->"207de498-38e6-4a12-8aa7-89277ca21014",
 CellID->1527058845],
Cell[150005, 4081, 17500, 485, 76, "Output",ExpressionUUID->"6457fef7-19d7-40e9-8ba6-70cc74b9d452",
 CellID->700942618]
}, Open  ]],
Cell[167520, 4569, 490, 13, 70, "TechNoteMathCaption",ExpressionUUID->"79fbf475-2029-4962-a1a3-a04d211c2587",
 CellID->1601110815],
Cell[CellGroupData[{
Cell[168035, 4586, 1122, 34, 70, "Input",ExpressionUUID->"c223bfaa-a713-4f39-add4-bfc4d937e57c",
 CellID->38369270],
Cell[169160, 4622, 17500, 485, 76, "Output",ExpressionUUID->"d2e9cf5b-5d68-4da3-9fb1-2e8794bb7f7a",
 CellID->225712167],
Cell[186663, 5109, 17501, 485, 76, "Output",ExpressionUUID->"9ea22c61-2989-4e9d-b6b8-6c7addea4f88",
 CellID->1088270167]
}, Open  ]],
Cell[204179, 5597, 186, 3, 70, "TechNoteMathCaption",ExpressionUUID->"ff3cc3dd-de55-4b67-bc2d-c7770b20f6fb",
 CellID->2067394127],
Cell[CellGroupData[{
Cell[204390, 5604, 698, 20, 70, "Input",ExpressionUUID->"adf25153-dba1-4e5a-9980-9ff5af18aa23",
 CellID->1604828370],
Cell[205091, 5626, 42007, 1044, 132, "Output",ExpressionUUID->"d117cbab-ea64-4079-8609-6cc744b17afa",
 CellID->47909730],
Cell[247101, 6672, 42009, 1044, 132, "Output",ExpressionUUID->"2b97a62d-f933-4c9c-b267-2ba0a6c654e4",
 CellID->2059948132]
}, Open  ]],
Cell[289125, 7719, 232, 4, 70, "TechNoteMathCaption",ExpressionUUID->"42668ab2-0ce1-4ab3-b5f6-061c7588e921",
 CellID->861429414],
Cell[CellGroupData[{
Cell[289382, 7727, 294, 6, 70, "Input",ExpressionUUID->"777e32d5-3edf-4731-b190-690cd8a34244",
 CellID->1196447817],
Cell[289679, 7735, 2333, 53, 281, "Output",ExpressionUUID->"1c22eb30-8454-419d-9330-349f47a2e2e6",
 CellID->307853044],
Cell[292015, 7790, 2333, 53, 281, "Output",ExpressionUUID->"be7ba98e-130c-4982-aaf2-6156f94f6223",
 CellID->798004885]
}, Open  ]],
Cell[294363, 7846, 158, 2, 70, "TechNoteMathCaption",ExpressionUUID->"b7f29345-bc7f-4261-910a-ac3bed0a7340",
 CellID->93724021],
Cell[CellGroupData[{
Cell[294546, 7852, 353, 10, 70, "Input",ExpressionUUID->"4f8c63bd-9d60-47e7-b117-79a4a00cc407",
 CellID->428846345],
Cell[294902, 7864, 128, 2, 36, "Output",ExpressionUUID->"90704de5-2cc3-41cc-89d7-493ef4eb842e",
 CellID->473646905],
Cell[295033, 7868, 129, 2, 36, "Output",ExpressionUUID->"a62609c7-f1bb-4506-b247-eaa02ac65aa3",
 CellID->2009136553]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295211, 7876, 125, 1, 70, "Subsection",ExpressionUUID->"5b51fd21-1a8e-40db-9ca4-2d97b1505571",
 CellID->1197910904],
Cell[295339, 7879, 225, 4, 70, "TechNoteText",ExpressionUUID->"545d1c56-5920-45a4-8008-f1a397582884",
 CellID->368440934],
Cell[295567, 7885, 537, 10, 70, "Input",ExpressionUUID->"4b958e15-d987-41e0-abc5-b9185f63b5e4",
 CellID->51525796],
Cell[296107, 7897, 327, 7, 70, "Input",ExpressionUUID->"b1a0849a-e0e4-4110-9379-03572ca61286",
 CellID->519669879],
Cell[296437, 7906, 2749, 74, 70, "Input",ExpressionUUID->"764b5ce3-5ce9-42f1-b3be-131a954406db",
 CellID->1699974289],
Cell[299189, 7982, 421, 9, 70, "TechNoteMathCaption",ExpressionUUID->"d42139df-0aa3-4a77-b6fe-81442593f640",
 CellID->415624317],
Cell[CellGroupData[{
Cell[299635, 7995, 302, 7, 70, "Input",ExpressionUUID->"9f81e7d2-a5a8-4b80-b0cc-79a435492494",
 CellID->584821147],
Cell[299940, 8004, 2233, 51, 281, "Output",ExpressionUUID->"68b5474a-ebc5-4218-9414-80c787c293d7",
 CellID->1412056904]
}, Open  ]],
Cell[302188, 8058, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8c5e052e-4a8e-44fb-b73a-ce8d6c784e30",
 CellID->914831718],
Cell[302357, 8062, 453, 13, 70, "Input",ExpressionUUID->"c932492d-99be-41c1-9919-3de001f27796",
 CellID->21183722],
Cell[302813, 8077, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"8ec11b73-d238-48f9-a270-0f97be90f10e",
 CellID->643016337],
Cell[CellGroupData[{
Cell[303042, 8085, 424, 11, 70, "Input",ExpressionUUID->"04ef3573-49c8-4b84-ae4a-2dd687116721",
 CellID->2108504836],
Cell[303469, 8098, 39774, 1040, 369, "Output",ExpressionUUID->"9adcd59f-d8de-42cc-84f5-b404b15a1261",
 CellID->658915986]
}, Open  ]],
Cell[343258, 9141, 207, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f5202df5-afe9-47fa-b064-9a4436567940",
 CellID->608333358],
Cell[CellGroupData[{
Cell[343490, 9149, 424, 11, 70, "Input",ExpressionUUID->"86fd9729-c9a9-4e2b-9a24-819d51c6fe42",
 CellID->2051353892],
Cell[343917, 9162, 39774, 1040, 369, "Output",ExpressionUUID->"d266b656-899f-4840-a965-29b3cf11a887",
 CellID->636306360]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383752, 10209, 110, 1, 70, "TechNoteSection",ExpressionUUID->"543e3914-c7ba-444b-85b0-e367e6251f35",
 CellID->1248933531],
Cell[383865, 10212, 407, 6, 70, "TechNoteText",ExpressionUUID->"c50697db-8ea8-4dae-9698-e81518c8fd9c",
 CellID->1308352194],
Cell[CellGroupData[{
Cell[384297, 10222, 982, 25, 70, "Input",ExpressionUUID->"bd78c7db-4888-4f7d-9d8d-d3e80a11d1f8",
 CellID->1320689739],
Cell[385282, 10249, 23927, 446, 524, "Output",ExpressionUUID->"66105c2c-c0eb-46cf-b5bb-7bdff93bf20f",
 CellID->1987750180]
}, Open  ]],
Cell[409224, 10698, 478, 10, 70, "TechNoteText",ExpressionUUID->"2c56d7fa-37c4-4ff3-bc38-624540bcf713",
 CellID->196356282],
Cell[CellGroupData[{
Cell[409727, 10712, 860, 22, 70, "Input",ExpressionUUID->"8c92cb94-c212-4b23-9574-a551be752d7d",
 CellID->1625149782],
Cell[410590, 10736, 116, 1, 70, "EchoTiming",ExpressionUUID->"7a122a9d-ab19-4c01-94ed-d4afc7dece29",
 CellID->1889298093]
}, Open  ]],
Cell[410721, 10740, 347, 8, 70, "TechNoteText",ExpressionUUID->"27cd6758-4e9a-4ab9-a03a-5d32b41fb8f2",
 CellID->47879881],
Cell[CellGroupData[{
Cell[411093, 10752, 130, 2, 70, "Input",ExpressionUUID->"525db037-2a05-40e8-8608-34b8eac855e0",
 CellID->1558275989],
Cell[411226, 10756, 11535, 315, 78, "Output",ExpressionUUID->"2b879a62-9746-4344-844b-ee4f650a4ee6",
 CellID->1053379672]
}, Open  ]],
Cell[422776, 11074, 217, 4, 70, "TechNoteText",ExpressionUUID->"8a2222a2-dadb-4ac1-918b-a1d277ec715e",
 CellID->1953490389],
Cell[CellGroupData[{
Cell[423018, 11082, 400, 12, 70, "Input",ExpressionUUID->"2dd2b211-3e22-4090-b6e3-470af69d8ed0",
 CellID->1582972587],
Cell[423421, 11096, 2574, 55, 54, "Output",ExpressionUUID->"10451ea2-9189-4334-9aa1-dd97f0738fac",
 CellID->367111081]
}, Open  ]],
Cell[CellGroupData[{
Cell[426032, 11156, 219, 5, 70, "Input",ExpressionUUID->"6432b5d2-2ea7-4af3-844a-27333810bcf5",
 CellID->1686302499],
Cell[426254, 11163, 4778, 127, 48, "Output",ExpressionUUID->"11124e8d-470f-40f0-bb2a-95fdd936f4a7",
 CellID->1859921424]
}, Open  ]],
Cell[CellGroupData[{
Cell[431069, 11295, 104, 1, 70, "Subsection",ExpressionUUID->"5c2b93ae-be33-40b7-b8ef-ff87a493a2fe",
 CellID->1711953502],
Cell[431176, 11298, 637, 15, 70, "TechNoteText",ExpressionUUID->"c7e7b19a-c245-42b9-afc6-94e338438ede",
 CellID->862841207],
Cell[431816, 11315, 331, 8, 70, "TechNoteText",ExpressionUUID->"b4416a65-1b9d-4504-8192-c4e67a1852e6",
 CellID->719303896],
Cell[432150, 11325, 1816, 56, 48, "Output",ExpressionUUID->"7f50fa65-79c4-4207-a529-353b4b07cfaa",
 CellID->2025483658],
Cell[433969, 11383, 192, 4, 70, "TechNoteText",ExpressionUUID->"ff58addb-5baa-44ef-bf49-bac6abdf8a72",
 CellID->994499068]
}, Open  ]]
}, Open  ]],
Cell[434188, 11391, 1396, 35, 70, "TutorialMoreAboutSection",ExpressionUUID->"ea02fdc9-7338-4a8e-917c-8960a1307170"],
Cell[435587, 11428, 2492, 65, 70, "RelatedTutorialsSection",ExpressionUUID->"4cdfaaed-da68-4c5f-914d-d67caccfaacb"],
Cell[438082, 11495, 3019, 81, 70, "TutorialRelatedLinksSection",ExpressionUUID->"2d9224c4-15a9-4a70-9fe7-5bf9c79f3405"]
}, Open  ]],
Cell[441116, 11579, 78, 0, 70, "FooterCell",ExpressionUUID->"b26e405a-1997-43bb-a19d-6129a0958dd8"]
}
]
*)

(* End of internal cache information *)

